<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Utxo</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{UTxO}
\label{sec:utxo}

\subsection{Accounting}

</a><a id="59" class="Markup">\begin{code}[hide]</a>
<a id="78" class="Symbol">{-#</a> <a id="82" class="Keyword">OPTIONS</a> <a id="90" class="Pragma">--safe</a> <a id="97" class="Symbol">#-}</a>

<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Algebra.html" class="Module">Algebra</a>              <a id="135" class="Keyword">using</a> <a id="141" class="Symbol">(</a><a id="142" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a><a id="159" class="Symbol">)</a>
<a id="161" class="Keyword">open</a> <a id="166" class="Keyword">import</a> <a id="173" href="Data.Integer.Ext.html" class="Module">Data.Integer.Ext</a>     <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Data.Integer.Ext.html#209" class="Function">posPart</a><a id="208" class="Symbol">;</a> <a id="210" href="Data.Integer.Ext.html#300" class="Function">negPart</a><a id="217" class="Symbol">)</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>  <a id="252" class="Keyword">using</a> <a id="258" class="Symbol">(</a><a id="259" href="Data.Nat.Properties.html#16387" class="Function">+-0-monoid</a><a id="269" class="Symbol">;</a> <a id="271" href="Data.Nat.Properties.html#16466" class="Function">+-0-commutativeMonoid</a><a id="292" class="Symbol">)</a>
<a id="294" class="Keyword">import</a> <a id="301" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="312" class="Symbol">as</a> <a id="315" class="Module">M</a>
<a id="317" class="Keyword">import</a> <a id="324" href="Data.Sum.Relation.Unary.All.html" class="Module">Data.Sum.Relation.Unary.All</a> <a id="352" class="Symbol">as</a> <a id="355" class="Module">Sum</a>

<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a>

<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>

<a id="480" class="Keyword">module</a> <a id="487" href="Ledger.Utxo.html" class="Module">Ledger.Utxo</a>
  <a id="501" class="Symbol">(</a><a id="502" href="Ledger.Utxo.html#502" class="Bound">txs</a> <a id="506" class="Symbol">:</a> <a id="508" class="Symbol">_)</a> <a id="511" class="Symbol">(</a><a id="512" class="Keyword">open</a> <a id="517" href="Ledger.Transaction.html#878" class="Module">TransactionStructure</a> <a id="538" href="Ledger.Utxo.html#502" class="Bound">txs</a><a id="541" class="Symbol">)</a>
  <a id="545" class="Symbol">(</a><a id="546" href="Ledger.Utxo.html#546" class="Bound">abs</a> <a id="550" class="Symbol">:</a> <a id="552" href="Ledger.Abstract.html#437" class="Record">AbstractFunctions</a> <a id="570" href="Ledger.Utxo.html#502" class="Bound">txs</a><a id="573" class="Symbol">)</a> <a id="575" class="Symbol">(</a><a id="576" class="Keyword">open</a> <a id="581" href="Ledger.Abstract.html#437" class="Module">AbstractFunctions</a> <a id="599" href="Ledger.Utxo.html#546" class="Bound">abs</a><a id="602" class="Symbol">)</a>
  <a id="606" class="Keyword">where</a>

<a id="613" class="Keyword">instance</a>
  <a id="624" href="Ledger.Utxo.html#624" class="Function">_</a> <a id="626" class="Symbol">=</a> <a id="628" href="Ledger.TokenAlgebra.html#534" class="Field">TokenAlgebra.Value-CommutativeMonoid</a> <a id="665" href="Ledger.Transaction.html#2599" class="Field">tokenAlgebra</a>
  <a id="680" href="Ledger.Utxo.html#680" class="Function">_</a> <a id="682" class="Symbol">=</a> <a id="684" href="Data.Nat.Properties.html#16387" class="Function">+-0-monoid</a>
  <a id="697" href="Ledger.Utxo.html#697" class="Function">_</a> <a id="699" class="Symbol">=</a> <a id="701" href="Data.Nat.Properties.html#16466" class="Function">+-0-commutativeMonoid</a>
  <a id="725" href="Ledger.Utxo.html#725" class="Function">_</a> <a id="727" class="Symbol">=</a> <a id="729" href="Ledger.Script.html#1154" class="Function">ExUnit-CommutativeMonoid</a>

  <a id="HasCoin-Map"></a><a id="757" href="Ledger.Utxo.html#757" class="Function">HasCoin-Map</a> <a id="769" class="Symbol">:</a> <a id="771" class="Symbol">∀</a> <a id="773" class="Symbol">{</a><a id="774" href="Ledger.Utxo.html#774" class="Bound">A</a><a id="775" class="Symbol">}</a> <a id="777" class="Symbol">→</a> <a id="779" class="Symbol">⦃</a> <a id="781" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="787" href="Ledger.Utxo.html#774" class="Bound">A</a> <a id="789" class="Symbol">⦄</a> <a id="791" class="Symbol">→</a> <a id="793" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="801" class="Symbol">(</a><a id="802" href="Ledger.Utxo.html#774" class="Bound">A</a> <a id="804" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="806" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a><a id="810" class="Symbol">)</a>
  <a id="814" href="Ledger.Utxo.html#757" class="Function">HasCoin-Map</a> <a id="826" class="Symbol">.</a><a id="827" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="835" href="Ledger.Utxo.html#835" class="Bound">s</a> <a id="837" class="Symbol">=</a> <a id="839" href="Axiom.Set.Sum.html#4411" class="Function">Σᵐᵛ[</a> <a id="844" href="Ledger.Utxo.html#844" class="Bound">x</a> <a id="846" href="Axiom.Set.Sum.html#4411" class="Function">←</a> <a id="848" href="Ledger.Utxo.html#835" class="Bound">s</a> <a id="850" href="Ledger.Set.Theory.html#2583" class="Function Operator">ᶠᵐ</a> <a id="853" href="Axiom.Set.Sum.html#4411" class="Function">]</a> <a id="855" href="Ledger.Utxo.html#844" class="Bound">x</a>

<a id="isPhaseTwoScriptAddress"></a><a id="858" href="Ledger.Utxo.html#858" class="Function">isPhaseTwoScriptAddress</a> <a id="882" class="Symbol">:</a> <a id="884" href="Ledger.Transaction.html#4647" class="Record">Tx</a> <a id="887" class="Symbol">→</a> <a id="889" href="Ledger.Address.html#1702" class="Function">Addr</a> <a id="894" class="Symbol">→</a> <a id="896" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="901" href="Ledger.Utxo.html#858" class="Function">isPhaseTwoScriptAddress</a> <a id="925" href="Ledger.Utxo.html#925" class="Bound">tx</a> <a id="928" href="Ledger.Utxo.html#928" class="Bound">a</a>
  <a id="932" class="Keyword">with</a> <a id="937" href="Ledger.Address.html#2758" class="Function">isScriptAddr?</a> <a id="951" href="Ledger.Utxo.html#928" class="Bound">a</a>
<a id="953" class="Symbol">...</a> <a id="957" class="Symbol">|</a> <a id="959" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a>  <a id="963" class="Symbol">_</a> <a id="965" class="Symbol">=</a> <a id="967" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="973" class="Symbol">...</a> <a id="977" class="Symbol">|</a> <a id="979" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="983" href="Ledger.Utxo.html#983" class="Bound">p</a>
  <a id="987" class="Keyword">with</a> <a id="992" href="Ledger.Transaction.html#5434" class="Function">lookupScriptHash</a> <a id="1009" class="Symbol">(</a><a id="1010" href="Ledger.Address.html#2933" class="Function">getScriptHash</a> <a id="1024" class="Bound">a</a> <a id="1026" href="Ledger.Utxo.html#983" class="Bound">p</a><a id="1027" class="Symbol">)</a> <a id="1029" class="Bound">tx</a>
<a id="1032" class="Symbol">...</a> <a id="1036" class="Symbol">|</a> <a id="1038" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="1046" class="Symbol">=</a> <a id="1048" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="1054" class="Symbol">...</a> <a id="1058" class="Symbol">|</a> <a id="1060" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1065" href="Ledger.Utxo.html#1065" class="Bound">s</a>  <a id="1068" class="Symbol">=</a> <a id="1070" href="Ledger.Transaction.html#5660" class="Function">isP2Script</a> <a id="1081" href="Ledger.Utxo.html#1065" class="Bound">s</a>

<a id="totExUnits"></a><a id="1084" href="Ledger.Utxo.html#1084" class="Function">totExUnits</a> <a id="1095" class="Symbol">:</a> <a id="1097" href="Ledger.Transaction.html#4647" class="Record">Tx</a> <a id="1100" class="Symbol">→</a> <a id="1102" href="Ledger.Script.html#1554" class="Function">ExUnits</a>
<a id="1110" href="Ledger.Utxo.html#1084" class="Function">totExUnits</a> <a id="1121" href="Ledger.Utxo.html#1121" class="Bound">tx</a> <a id="1124" class="Symbol">=</a> <a id="1126" href="Axiom.Set.Sum.html#4302" class="Function">Σᵐ[</a> <a id="1130" href="Ledger.Utxo.html#1130" class="Bound">x</a> <a id="1132" href="Axiom.Set.Sum.html#4302" class="Function">←</a> <a id="1134" href="Ledger.Utxo.html#1121" class="Bound">tx</a> <a id="1137" class="Symbol">.</a><a id="1138" href="Ledger.Transaction.html#4700" class="Field">wits</a> <a id="1143" class="Symbol">.</a><a id="1144" href="Ledger.Transaction.html#4526" class="Field">txrdmrs</a> <a id="1152" href="Ledger.Set.Theory.html#2583" class="Function Operator">ᶠᵐ</a> <a id="1155" href="Axiom.Set.Sum.html#4302" class="Function">]</a> <a id="1157" class="Symbol">(</a><a id="1158" href="Ledger.Utxo.html#1130" class="Bound">x</a> <a id="1160" class="Symbol">.</a><a id="1161" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="1167" class="Symbol">.</a><a id="1168" href="Data.Product.Base.html#622" class="Field">proj₂</a><a id="1173" class="Symbol">)</a>
  <a id="1177" class="Keyword">where</a> <a id="1183" class="Keyword">open</a> <a id="1188" href="Ledger.Transaction.html#4647" class="Module">Tx</a><a id="1190" class="Symbol">;</a> <a id="1192" class="Keyword">open</a> <a id="1197" href="Ledger.Transaction.html#4392" class="Module">TxWitnesses</a>

<a id="1210" class="Comment">-- utxoEntrySizeWithoutVal = 27 words (8 bytes)</a>
<a id="utxoEntrySizeWithoutVal"></a><a id="1258" href="Ledger.Utxo.html#1258" class="Function">utxoEntrySizeWithoutVal</a> <a id="1282" class="Symbol">:</a> <a id="1284" href="Ledger.TokenAlgebra.html#587" class="Function">MemoryEstimate</a>
<a id="1299" href="Ledger.Utxo.html#1258" class="Function">utxoEntrySizeWithoutVal</a> <a id="1323" class="Symbol">=</a> <a id="1325" class="Number">8</a>

<a id="utxoEntrySize"></a><a id="1328" href="Ledger.Utxo.html#1328" class="Function">utxoEntrySize</a> <a id="1342" class="Symbol">:</a> <a id="1344" href="Ledger.Transaction.html#3246" class="Function">TxOut</a> <a id="1350" class="Symbol">→</a> <a id="1352" href="Ledger.TokenAlgebra.html#587" class="Function">MemoryEstimate</a>
<a id="1367" href="Ledger.Utxo.html#1328" class="Function">utxoEntrySize</a> <a id="1381" href="Ledger.Utxo.html#1381" class="Bound">utxo</a> <a id="1386" class="Symbol">=</a> <a id="1388" href="Ledger.Utxo.html#1258" class="Function">utxoEntrySizeWithoutVal</a> <a id="1412" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="1414" href="Ledger.TokenAlgebra.html#1080" class="Function">size</a> <a id="1419" class="Symbol">(</a><a id="1420" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="1429" href="Ledger.Utxo.html#1381" class="Bound">utxo</a><a id="1433" class="Symbol">)</a>

<a id="1436" class="Keyword">open</a> <a id="1441" href="Ledger.PParams.html#1143" class="Module">PParams</a>
<a id="1449" class="Markup">\end{code}</a><a id="1459" class="Background">

Figure~\ref{fig:functions:utxo} defines functions needed for the UTxO transition system.
Figure~\ref{fig:ts-types:utxo-shelley} defines the types needed for the UTxO transition system.
The UTxO transition system is given in Figure~\ref{fig:rules:utxo-shelley}.

\begin{itemize}

  \item
    The function $\fun{outs}$ creates the unspent outputs generated by a transaction.
    It maps the transaction id and output index to the output.

  \item
    The $\fun{balance}$ function calculates sum total of all the coin in a given UTxO.
\end{itemize}

\AgdaTarget{outs, minfee, inInterval, balance}
\begin{figure*}[h]
</a><a id="2074" class="Markup">\begin{code}[hide]</a>
<a id="2093" class="Keyword">module</a> <a id="2100" href="Ledger.Utxo.html#2100" class="Module">_</a> <a id="2102" class="Symbol">(</a><a id="2103" class="Keyword">let</a> <a id="2107" class="Keyword">open</a> <a id="2112" href="Ledger.Transaction.html#4647" class="Module">Tx</a><a id="2114" class="Symbol">;</a> <a id="2116" class="Keyword">open</a> <a id="2121" href="Ledger.Transaction.html#3692" class="Module">TxBody</a><a id="2127" class="Symbol">)</a> <a id="2129" class="Keyword">where</a>
<a id="2135" class="Markup">\end{code}</a><a id="2145" class="Background">
</a><a id="2146" class="Markup">\begin{code}</a>
  <a id="2161" href="Ledger.Utxo.html#2161" class="Function">outs</a> <a id="2166" class="Symbol">:</a> <a id="2168" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="2175" class="Symbol">→</a> <a id="2177" href="Ledger.Transaction.html#3286" class="Function">UTxO</a>
  <a id="2184" href="Ledger.Utxo.html#2161" class="Function">outs</a> <a id="2189" href="Ledger.Utxo.html#2189" class="Bound">tx</a> <a id="2192" class="Symbol">=</a> <a id="2194" href="Axiom.Set.Map.html#6808" class="Function">mapKeys</a> <a id="2202" class="Symbol">(</a><a id="2203" href="Ledger.Utxo.html#2189" class="Bound">tx</a> <a id="2206" class="Symbol">.</a><a id="2207" href="Ledger.Transaction.html#4245" class="Field">txid</a> <a id="2212" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,_</a><a id="2214" class="Symbol">)</a> <a id="2216" class="Symbol">(</a><a id="2217" href="Ledger.Utxo.html#2189" class="Bound">tx</a> <a id="2220" class="Symbol">.</a><a id="2221" href="Ledger.Transaction.html#3755" class="Field">txouts</a><a id="2227" class="Symbol">)</a>

  <a id="2232" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="Ledger.Transaction.html#3286" class="Function">UTxO</a> <a id="2247" class="Symbol">→</a> <a id="2249" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="2257" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="2265" href="Ledger.Utxo.html#2265" class="Bound">utxo</a> <a id="2270" class="Symbol">=</a> <a id="2272" href="Axiom.Set.Sum.html#4411" class="Function">Σᵐᵛ[</a> <a id="2277" href="Ledger.Utxo.html#2277" class="Bound">x</a> <a id="2279" href="Axiom.Set.Sum.html#4411" class="Function">←</a> <a id="2281" href="Ledger.Utxo.html#2265" class="Bound">utxo</a> <a id="2286" href="Ledger.Set.Theory.html#2583" class="Function Operator">ᶠᵐ</a> <a id="2289" href="Axiom.Set.Sum.html#4411" class="Function">]</a> <a id="2291" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="2300" href="Ledger.Utxo.html#2277" class="Bound">x</a>

  <a id="2305" href="Ledger.Utxo.html#2305" class="Function">cbalance</a> <a id="2314" class="Symbol">:</a> <a id="2316" href="Ledger.Transaction.html#3286" class="Function">UTxO</a> <a id="2321" class="Symbol">→</a> <a id="2323" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="2330" href="Ledger.Utxo.html#2305" class="Function">cbalance</a> <a id="2339" href="Ledger.Utxo.html#2339" class="Bound">utxo</a> <a id="2344" class="Symbol">=</a> <a id="2346" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="2360" href="Ledger.Utxo.html#2339" class="Bound">utxo</a><a id="2364" class="Symbol">)</a>

  <a id="2369" href="Ledger.Utxo.html#2369" class="Function">coinPolicies</a> <a id="2382" class="Symbol">:</a> <a id="2384" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="2386" href="Ledger.Crypto.html#1595" class="Function">ScriptHash</a>
  <a id="2399" href="Ledger.Utxo.html#2369" class="Function">coinPolicies</a> <a id="2412" class="Symbol">=</a> <a id="2414" href="Ledger.TokenAlgebra.html#1024" class="Function">policies</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="2431" class="Number">1</a><a id="2432" class="Symbol">)</a>

  <a id="2437" href="Ledger.Utxo.html#2437" class="Function">isAdaOnlyᵇ</a> <a id="2448" class="Symbol">:</a> <a id="2450" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="2456" class="Symbol">→</a> <a id="2458" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
  <a id="2465" href="Ledger.Utxo.html#2437" class="Function">isAdaOnlyᵇ</a> <a id="2476" href="Ledger.Utxo.html#2476" class="Bound">v</a> <a id="2478" class="Symbol">=</a> <a id="2480" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Ledger.TokenAlgebra.html#1024" class="Function">policies</a> <a id="2492" href="Ledger.Utxo.html#2476" class="Bound">v</a><a id="2493" class="Symbol">)</a> <a id="2495" href="Axiom.Set.html#10732" class="Function Operator">≡ᵉ?</a> <a id="2499" href="Ledger.Utxo.html#2369" class="Function">coinPolicies</a> <a id="2512" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌋</a>

  <a id="2517" href="Ledger.Utxo.html#2517" class="Function">minfee</a> <a id="2524" class="Symbol">:</a> <a id="2526" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="2534" class="Symbol">→</a> <a id="2536" href="Ledger.Transaction.html#4647" class="Record">Tx</a> <a id="2539" class="Symbol">→</a> <a id="2541" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="2548" href="Ledger.Utxo.html#2517" class="Function">minfee</a> <a id="2555" href="Ledger.Utxo.html#2555" class="Bound">pp</a> <a id="2558" href="Ledger.Utxo.html#2558" class="Bound">tx</a>  <a id="2562" class="Symbol">=</a> <a id="2564" href="Ledger.Utxo.html#2555" class="Bound">pp</a> <a id="2567" class="Symbol">.</a><a id="2568" href="Ledger.PParams.html#1569" class="Field">a</a> <a id="2570" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="2572" href="Ledger.Utxo.html#2558" class="Bound">tx</a> <a id="2575" class="Symbol">.</a><a id="2576" href="Ledger.Transaction.html#4672" class="Field">body</a> <a id="2581" class="Symbol">.</a><a id="2582" href="Ledger.Transaction.html#4216" class="Field">txsize</a> <a id="2589" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="2591" href="Ledger.Utxo.html#2555" class="Bound">pp</a> <a id="2594" class="Symbol">.</a><a id="2595" href="Ledger.PParams.html#1600" class="Field">b</a>
                <a id="2613" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="2615" href="Ledger.Abstract.html#475" class="Field">txscriptfee</a> <a id="2627" class="Symbol">(</a><a id="2628" href="Ledger.Utxo.html#2555" class="Bound">pp</a> <a id="2631" class="Symbol">.</a><a id="2632" href="Ledger.PParams.html#2505" class="Field">prices</a><a id="2638" class="Symbol">)</a> <a id="2640" class="Symbol">(</a><a id="2641" href="Ledger.Utxo.html#1084" class="Function">totExUnits</a> <a id="2652" href="Ledger.Utxo.html#2558" class="Bound">tx</a><a id="2654" class="Symbol">)</a>

  <a id="2659" class="Keyword">data</a> <a id="2664" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="2679" class="Symbol">:</a> <a id="2681" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2685" class="Keyword">where</a>
    <a id="2695" href="Ledger.Utxo.html#2695" class="InductiveConstructor">CredentialDeposit</a>  <a id="2714" class="Symbol">:</a> <a id="2716" href="Ledger.Address.html#713" class="Function">Credential</a>   <a id="2729" class="Symbol">→</a> <a id="2731" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>
    <a id="2750" href="Ledger.Utxo.html#2750" class="InductiveConstructor">PoolDeposit</a>        <a id="2769" class="Symbol">:</a> <a id="2771" href="Ledger.Address.html#713" class="Function">Credential</a>   <a id="2784" class="Symbol">→</a> <a id="2786" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>
    <a id="2805" href="Ledger.Utxo.html#2805" class="InductiveConstructor">DRepDeposit</a>        <a id="2824" class="Symbol">:</a> <a id="2826" href="Ledger.Address.html#713" class="Function">Credential</a>   <a id="2839" class="Symbol">→</a> <a id="2841" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>
    <a id="2860" href="Ledger.Utxo.html#2860" class="InductiveConstructor">GovActionDeposit</a>   <a id="2879" class="Symbol">:</a> <a id="2881" href="Ledger.GovernanceActions.html#999" class="Function">GovActionID</a>  <a id="2894" class="Symbol">→</a> <a id="2896" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>

  <a id="2914" href="Ledger.Utxo.html#2914" class="Function">certDeposit</a> <a id="2926" class="Symbol">:</a> <a id="2928" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="2936" class="Symbol">→</a> <a id="2938" href="Ledger.Deleg.html#353" class="Datatype">DCert</a> <a id="2944" class="Symbol">→</a> <a id="2946" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2952" class="Symbol">(</a><a id="2953" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="2968" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="2970" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a><a id="2974" class="Symbol">)</a>
  <a id="2978" href="Ledger.Utxo.html#2914" class="Function">certDeposit</a> <a id="2990" class="Symbol">_</a>   <a id="2994" class="Symbol">(</a><a id="2995" href="Ledger.Deleg.html#373" class="InductiveConstructor">delegate</a> <a id="3004" href="Ledger.Utxo.html#3004" class="Bound">c</a> <a id="3006" class="Symbol">_</a> <a id="3008" class="Symbol">_</a> <a id="3010" href="Ledger.Utxo.html#3010" class="Bound">v</a><a id="3011" class="Symbol">)</a>  <a id="3014" class="Symbol">=</a> <a id="3016" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3021" class="Symbol">(</a><a id="3022" href="Ledger.Utxo.html#2695" class="InductiveConstructor">CredentialDeposit</a> <a id="3040" href="Ledger.Utxo.html#3004" class="Bound">c</a> <a id="3042" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3044" href="Ledger.Utxo.html#3010" class="Bound">v</a><a id="3045" class="Symbol">)</a>
  <a id="3049" href="Ledger.Utxo.html#2914" class="Function">certDeposit</a> <a id="3061" href="Ledger.Utxo.html#3061" class="Bound">pp</a>  <a id="3065" class="Symbol">(</a><a id="3066" href="Ledger.Deleg.html#449" class="InductiveConstructor">regpool</a> <a id="3074" href="Ledger.Utxo.html#3074" class="Bound">c</a> <a id="3076" class="Symbol">_)</a>       <a id="3085" class="Symbol">=</a> <a id="3087" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3092" class="Symbol">(</a><a id="3093" href="Ledger.Utxo.html#2750" class="InductiveConstructor">PoolDeposit</a>       <a id="3111" href="Ledger.Utxo.html#3074" class="Bound">c</a> <a id="3113" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3115" href="Ledger.Utxo.html#3061" class="Bound">pp</a> <a id="3118" class="Symbol">.</a><a id="3119" href="Ledger.PParams.html#1665" class="Field">poolDeposit</a><a id="3130" class="Symbol">)</a>
  <a id="3134" href="Ledger.Utxo.html#2914" class="Function">certDeposit</a> <a id="3146" class="Symbol">_</a>   <a id="3150" class="Symbol">(</a><a id="3151" href="Ledger.Deleg.html#540" class="InductiveConstructor">regdrep</a> <a id="3159" href="Ledger.Utxo.html#3159" class="Bound">c</a> <a id="3161" href="Ledger.Utxo.html#3161" class="Bound">v</a> <a id="3163" class="Symbol">_)</a>     <a id="3170" class="Symbol">=</a> <a id="3172" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3177" class="Symbol">(</a><a id="3178" href="Ledger.Utxo.html#2805" class="InductiveConstructor">DRepDeposit</a>       <a id="3196" href="Ledger.Utxo.html#3159" class="Bound">c</a> <a id="3198" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3200" href="Ledger.Utxo.html#3161" class="Bound">v</a><a id="3201" class="Symbol">)</a>
  <a id="3205" href="Ledger.Utxo.html#2914" class="CatchallClause Function">certDeposit</a><a id="3216" class="CatchallClause"> </a><a id="3217" class="CatchallClause Symbol">_</a><a id="3218" class="CatchallClause">   </a><a id="3221" class="CatchallClause Symbol">_</a>                   <a id="3241" class="Symbol">=</a> <a id="3243" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

  <a id="3254" href="Ledger.Utxo.html#3254" class="Function">certDepositᵐ</a> <a id="3267" class="Symbol">:</a> <a id="3269" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="3277" class="Symbol">→</a> <a id="3279" href="Ledger.Deleg.html#353" class="Datatype">DCert</a> <a id="3285" class="Symbol">→</a> <a id="3287" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="3302" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="3304" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="3311" href="Ledger.Utxo.html#3254" class="Function">certDepositᵐ</a> <a id="3324" href="Ledger.Utxo.html#3324" class="Bound">pp</a> <a id="3327" href="Ledger.Utxo.html#3327" class="Bound">cert</a> <a id="3332" class="Symbol">=</a> <a id="3334" href="Function.Base.html#4053" class="Function Operator">case</a> <a id="3339" href="Ledger.Utxo.html#2914" class="Function">certDeposit</a> <a id="3351" href="Ledger.Utxo.html#3324" class="Bound">pp</a> <a id="3354" href="Ledger.Utxo.html#3327" class="Bound">cert</a> <a id="3359" href="Function.Base.html#4053" class="Function Operator">of</a> <a id="3362" class="Symbol">λ</a> <a id="3364" class="Keyword">where</a>
    <a id="3374" class="Symbol">(</a><a id="3375" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3380" class="Symbol">(</a><a id="3381" href="Ledger.Utxo.html#3381" class="Bound">p</a> <a id="3383" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3385" href="Ledger.Utxo.html#3385" class="Bound">v</a><a id="3386" class="Symbol">))</a>  <a id="3390" class="Symbol">→</a> <a id="3392" href="Axiom.Set.Map.html#4711" class="Function Operator">❴</a> <a id="3394" href="Ledger.Utxo.html#3381" class="Bound">p</a> <a id="3396" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3398" href="Ledger.Utxo.html#3385" class="Bound">v</a> <a id="3400" href="Axiom.Set.Map.html#4711" class="Function Operator">❵ᵐ</a>
    <a id="3407" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>         <a id="3423" class="Symbol">→</a> <a id="3425" href="Axiom.Set.Map.html#2784" class="Function">∅ᵐ</a>

  <a id="3431" href="Ledger.Utxo.html#3431" class="Function">propDepositᵐ</a> <a id="3444" class="Symbol">:</a> <a id="3446" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="3454" class="Symbol">→</a> <a id="3456" href="Ledger.GovernanceActions.html#999" class="Function">GovActionID</a> <a id="3468" class="Symbol">→</a> <a id="3470" href="Ledger.GovernanceActions.html#8716" class="Record">GovProposal</a> <a id="3482" class="Symbol">→</a> <a id="3484" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="3499" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="3501" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="3508" href="Ledger.Utxo.html#3431" class="Function">propDepositᵐ</a> <a id="3521" href="Ledger.Utxo.html#3521" class="Bound">pp</a> <a id="3524" href="Ledger.Utxo.html#3524" class="Bound">gaid</a> <a id="3529" class="Keyword">record</a> <a id="3536" class="Symbol">{</a> <a id="3538" href="Ledger.GovernanceActions.html#8748" class="Field">returnAddr</a> <a id="3549" class="Symbol">=</a> <a id="3551" class="Keyword">record</a> <a id="3558" class="Symbol">{</a> <a id="3560" href="Ledger.Address.html#1269" class="Field">stake</a> <a id="3566" class="Symbol">=</a> <a id="3568" href="Ledger.Utxo.html#3568" class="Bound">c</a> <a id="3570" class="Symbol">}</a> <a id="3572" class="Symbol">}</a>
    <a id="3578" class="Symbol">=</a> <a id="3580" href="Axiom.Set.Map.html#4711" class="Function Operator">❴</a> <a id="3582" href="Ledger.Utxo.html#2860" class="InductiveConstructor">GovActionDeposit</a> <a id="3599" href="Ledger.Utxo.html#3524" class="Bound">gaid</a> <a id="3604" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3606" href="Ledger.Utxo.html#3521" class="Bound">pp</a> <a id="3609" class="Symbol">.</a><a id="3610" href="Ledger.PParams.html#2164" class="Field">govActionDeposit</a> <a id="3627" href="Axiom.Set.Map.html#4711" class="Function Operator">❵ᵐ</a>

  <a id="3633" href="Ledger.Utxo.html#3633" class="Function">certRefund</a> <a id="3644" class="Symbol">:</a> <a id="3646" href="Ledger.Deleg.html#353" class="Datatype">DCert</a> <a id="3652" class="Symbol">→</a> <a id="3654" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3660" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>
  <a id="3677" href="Ledger.Utxo.html#3633" class="Function">certRefund</a> <a id="3688" class="Symbol">(</a><a id="3689" href="Ledger.Deleg.html#373" class="InductiveConstructor">delegate</a> <a id="3698" href="Ledger.Utxo.html#3698" class="Bound">c</a> <a id="3700" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="3708" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="3716" href="Ledger.Utxo.html#3716" class="Bound">x</a><a id="3717" class="Symbol">)</a>  <a id="3720" class="Symbol">=</a> <a id="3722" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3727" class="Symbol">(</a><a id="3728" href="Ledger.Utxo.html#2695" class="InductiveConstructor">CredentialDeposit</a> <a id="3746" href="Ledger.Utxo.html#3698" class="Bound">c</a><a id="3747" class="Symbol">)</a>
  <a id="3751" href="Ledger.Utxo.html#3633" class="Function">certRefund</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Ledger.Deleg.html#591" class="InductiveConstructor">deregdrep</a> <a id="3773" href="Ledger.Utxo.html#3773" class="Bound">c</a><a id="3774" class="Symbol">)</a>                   <a id="3794" class="Symbol">=</a> <a id="3796" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3801" class="Symbol">(</a><a id="3802" href="Ledger.Utxo.html#2805" class="InductiveConstructor">DRepDeposit</a>       <a id="3820" href="Ledger.Utxo.html#3773" class="Bound">c</a><a id="3821" class="Symbol">)</a>
  <a id="3825" href="Ledger.Utxo.html#3633" class="CatchallClause Function">certRefund</a><a id="3835" class="CatchallClause"> </a><a id="3836" class="CatchallClause Symbol">_</a>                               <a id="3868" class="Symbol">=</a> <a id="3870" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

  <a id="3881" href="Ledger.Utxo.html#3881" class="Function">certRefundˢ</a> <a id="3893" class="Symbol">:</a> <a id="3895" href="Ledger.Deleg.html#353" class="Datatype">DCert</a> <a id="3901" class="Symbol">→</a> <a id="3903" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="3905" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a>
  <a id="3922" href="Ledger.Utxo.html#3881" class="Function">certRefundˢ</a> <a id="3934" class="Symbol">=</a> <a id="3936" href="Axiom.Set.html#6275" class="Function">partialToSet</a> <a id="3949" href="Ledger.Utxo.html#3633" class="Function">certRefund</a>

<a id="3961" class="Comment">-- this has to be a type definition for inference to work</a>
<a id="4019" class="Keyword">data</a> <a id="inInterval"></a><a id="4024" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="4035" class="Symbol">(</a><a id="4036" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4041" class="Symbol">:</a> <a id="4043" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="4047" class="Symbol">)</a> <a id="4049" class="Symbol">:</a> <a id="4051" class="Symbol">(</a><a id="4052" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4058" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="4063" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="4065" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4071" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="4075" class="Symbol">)</a> <a id="4077" class="Symbol">→</a> <a id="4079" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="4083" class="Keyword">where</a>
  <a id="inInterval.both"></a><a id="4091" href="Ledger.Utxo.html#4091" class="InductiveConstructor">both</a>   <a id="4098" class="Symbol">:</a> <a id="4100" class="Symbol">∀</a> <a id="4102" class="Symbol">{</a><a id="4103" href="Ledger.Utxo.html#4103" class="Bound">l</a> <a id="4105" href="Ledger.Utxo.html#4105" class="Bound">r</a><a id="4106" class="Symbol">}</a>  <a id="4109" class="Symbol">→</a> <a id="4111" href="Ledger.Utxo.html#4103" class="Bound">l</a> <a id="4113" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="4115" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4120" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="4122" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4127" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="4129" href="Ledger.Utxo.html#4105" class="Bound">r</a>  <a id="4132" class="Symbol">→</a>  <a id="4135" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="4146" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4157" href="Ledger.Utxo.html#4103" class="Bound">l</a>   <a id="4161" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4163" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4168" href="Ledger.Utxo.html#4105" class="Bound">r</a><a id="4169" class="Symbol">)</a>
  <a id="inInterval.lower"></a><a id="4173" href="Ledger.Utxo.html#4173" class="InductiveConstructor">lower</a>  <a id="4180" class="Symbol">:</a> <a id="4182" class="Symbol">∀</a> <a id="4184" class="Symbol">{</a><a id="4185" href="Ledger.Utxo.html#4185" class="Bound">l</a><a id="4186" class="Symbol">}</a>    <a id="4191" class="Symbol">→</a> <a id="4193" href="Ledger.Utxo.html#4185" class="Bound">l</a> <a id="4195" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="4197" href="Ledger.Utxo.html#4036" class="Bound">slot</a>             <a id="4214" class="Symbol">→</a>  <a id="4217" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="4228" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4233" class="Symbol">(</a><a id="4234" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4239" href="Ledger.Utxo.html#4185" class="Bound">l</a>   <a id="4243" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4245" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="4252" class="Symbol">)</a>
  <a id="inInterval.upper"></a><a id="4256" href="Ledger.Utxo.html#4256" class="InductiveConstructor">upper</a>  <a id="4263" class="Symbol">:</a> <a id="4265" class="Symbol">∀</a> <a id="4267" class="Symbol">{</a><a id="4268" href="Ledger.Utxo.html#4268" class="Bound">r</a><a id="4269" class="Symbol">}</a>    <a id="4274" class="Symbol">→</a> <a id="4276" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4281" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="4283" href="Ledger.Utxo.html#4268" class="Bound">r</a>             <a id="4297" class="Symbol">→</a>  <a id="4300" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="4311" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4316" class="Symbol">(</a><a id="4317" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>  <a id="4326" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4328" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4333" href="Ledger.Utxo.html#4268" class="Bound">r</a><a id="4334" class="Symbol">)</a>
  <a id="inInterval.none"></a><a id="4338" href="Ledger.Utxo.html#4338" class="InductiveConstructor">none</a>   <a id="4345" class="Symbol">:</a>                                    <a id="4382" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="4393" href="Ledger.Utxo.html#4036" class="Bound">slot</a> <a id="4398" class="Symbol">(</a><a id="4399" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>  <a id="4408" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4410" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="4417" class="Symbol">)</a>

<a id="4420" class="Comment">-----------------------------------------------------</a>
<a id="4474" class="Comment">-- Boolean Functions</a>

<a id="4496" class="Comment">-- Boolean Implication</a>
<a id="_=&gt;ᵇ_"></a><a id="4519" href="Ledger.Utxo.html#4519" class="Function Operator">_=&gt;ᵇ_</a> <a id="4525" class="Symbol">:</a> <a id="4527" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a> <a id="4532" class="Symbol">→</a> <a id="4534" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a> <a id="4539" class="Symbol">→</a> <a id="4541" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="4546" href="Ledger.Utxo.html#4546" class="Bound">a</a> <a id="4548" href="Ledger.Utxo.html#4519" class="Function Operator">=&gt;ᵇ</a> <a id="4552" href="Ledger.Utxo.html#4552" class="Bound">b</a> <a id="4554" class="Symbol">=</a> <a id="4556" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4559" href="Ledger.Utxo.html#4546" class="Bound">a</a> <a id="4561" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4566" href="Ledger.Utxo.html#4552" class="Bound">b</a> <a id="4568" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4573" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>

<a id="_≤ᵇ_"></a><a id="4579" href="Ledger.Utxo.html#4579" class="Function Operator">_≤ᵇ_</a> <a id="_≥ᵇ_"></a><a id="4584" href="Ledger.Utxo.html#4584" class="Function Operator">_≥ᵇ_</a> <a id="4589" class="Symbol">:</a> <a id="4591" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4593" class="Symbol">→</a> <a id="4595" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4597" class="Symbol">→</a> <a id="4599" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="4604" href="Ledger.Utxo.html#4604" class="Bound">m</a> <a id="4606" href="Ledger.Utxo.html#4579" class="Function Operator">≤ᵇ</a> <a id="4609" href="Ledger.Utxo.html#4609" class="Bound">n</a> <a id="4611" class="Symbol">=</a> <a id="4613" href="Interface.Decidable.Instance.html#1136" class="Function Operator">¿</a> <a id="4615" href="Ledger.Utxo.html#4604" class="Bound">m</a> <a id="4617" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="4619" href="Ledger.Utxo.html#4609" class="Bound">n</a> <a id="4621" href="Interface.Decidable.Instance.html#1136" class="Function Operator">¿ᵇ</a>
<a id="4624" href="Ledger.Utxo.html#4584" class="Function Operator">_≥ᵇ_</a> <a id="4629" class="Symbol">=</a> <a id="4631" href="Function.Base.html#1629" class="Function">flip</a> <a id="4636" href="Ledger.Utxo.html#4579" class="Function Operator">_≤ᵇ_</a>

<a id="≟-∅ᵇ"></a><a id="4642" href="Ledger.Utxo.html#4642" class="Function">≟-∅ᵇ</a> <a id="4647" class="Symbol">:</a> <a id="4649" class="Symbol">{</a><a id="4650" href="Ledger.Utxo.html#4650" class="Bound">A</a> <a id="4652" class="Symbol">:</a> <a id="4654" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="4657" class="Symbol">}</a> <a id="4659" class="Symbol">⦃</a> <a id="4661" href="Ledger.Utxo.html#4661" class="Bound">_</a> <a id="4663" class="Symbol">:</a> <a id="4665" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="4671" href="Ledger.Utxo.html#4650" class="Bound">A</a> <a id="4673" class="Symbol">⦄</a> <a id="4675" class="Symbol">→</a> <a id="4677" class="Symbol">(</a><a id="4678" href="Ledger.Utxo.html#4678" class="Bound">X</a> <a id="4680" class="Symbol">:</a> <a id="4682" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="4684" href="Ledger.Utxo.html#4650" class="Bound">A</a><a id="4685" class="Symbol">)</a> <a id="4687" class="Symbol">→</a> <a id="4689" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="4694" href="Ledger.Utxo.html#4642" class="Function">≟-∅ᵇ</a> <a id="4699" href="Ledger.Utxo.html#4699" class="Bound">X</a> <a id="4701" class="Symbol">=</a> <a id="4703" href="Interface.Decidable.Instance.html#1136" class="Function Operator">¿</a> <a id="4705" href="Ledger.Utxo.html#4699" class="Bound">X</a> <a id="4707" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4709" href="Axiom.Set.html#5746" class="Function">∅</a> <a id="4711" href="Interface.Decidable.Instance.html#1136" class="Function Operator">¿ᵇ</a>

<a id="4715" class="Comment">-----------------------------------------------------</a>

<a id="4770" class="Comment">-- TODO: this could be a regular property</a>

<a id="feesOK"></a><a id="4813" href="Ledger.Utxo.html#4813" class="Function">feesOK</a> <a id="4820" class="Symbol">:</a> <a id="4822" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="4830" class="Symbol">→</a> <a id="4832" href="Ledger.Transaction.html#4647" class="Record">Tx</a> <a id="4835" class="Symbol">→</a> <a id="4837" href="Ledger.Transaction.html#3286" class="Function">UTxO</a> <a id="4842" class="Symbol">→</a> <a id="4844" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
<a id="4849" href="Ledger.Utxo.html#4813" class="Function">feesOK</a> <a id="4856" href="Ledger.Utxo.html#4856" class="Bound">pp</a> <a id="4859" href="Ledger.Utxo.html#4859" class="Bound">tx</a> <a id="4862" href="Ledger.Utxo.html#4862" class="Bound">utxo</a> <a id="4867" class="Symbol">=</a> <a id="4869" href="Ledger.Utxo.html#2517" class="Function">minfee</a> <a id="4876" href="Ledger.Utxo.html#4856" class="Bound">pp</a> <a id="4879" href="Ledger.Utxo.html#4859" class="Bound">tx</a> <a id="4882" href="Ledger.Utxo.html#4579" class="Function Operator">≤ᵇ</a> <a id="4885" href="Ledger.Transaction.html#3793" class="Function">txfee</a>
                  <a id="4909" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="4911" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="4915" class="Symbol">(</a><a id="4916" href="Ledger.Utxo.html#4642" class="Function">≟-∅ᵇ</a> <a id="4921" class="Symbol">(</a><a id="4922" href="Ledger.Transaction.html#4526" class="Function">txrdmrs</a> <a id="4930" href="Axiom.Set.Map.html#2338" class="Function Operator">ˢ</a><a id="4931" class="Symbol">))</a>
                  <a id="4952" href="Ledger.Utxo.html#4519" class="Function Operator">=&gt;ᵇ</a> <a id="4956" class="Symbol">(</a> <a id="4958" href="Axiom.Set.html#11236" class="Function">allᵇ</a> <a id="4963" class="Symbol">(</a><a id="4964" href="Ledger.Address.html#2581" class="Function">isVKeyAddr?</a> <a id="4976" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4978" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="4983" class="Symbol">)</a> <a id="4985" href="Ledger.Utxo.html#5271" class="Function">collateralRange</a>
                      <a id="5023" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5025" href="Ledger.Utxo.html#2437" class="Function">isAdaOnlyᵇ</a> <a id="5036" href="Ledger.Utxo.html#5328" class="Function">bal</a>
                      <a id="5062" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5064" class="Symbol">(</a><a id="5065" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="5070" href="Ledger.Utxo.html#5328" class="Function">bal</a> <a id="5074" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="5076" class="Number">100</a><a id="5079" class="Symbol">)</a> <a id="5081" href="Ledger.Utxo.html#4584" class="Function Operator">≥ᵇ</a> <a id="5084" class="Symbol">(</a><a id="5085" href="Ledger.Transaction.html#3793" class="Function">txfee</a> <a id="5091" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="5093" href="Ledger.Utxo.html#4856" class="Bound">pp</a> <a id="5096" class="Symbol">.</a><a id="5097" href="Ledger.PParams.html#1818" class="Field">collateralPercent</a><a id="5114" class="Symbol">)</a>
                      <a id="5138" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="5140" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="5144" class="Symbol">(</a><a id="5145" href="Ledger.Utxo.html#4642" class="Function">≟-∅ᵇ</a> <a id="5150" href="Ledger.Transaction.html#4277" class="Function">collateral</a><a id="5160" class="Symbol">)</a>
                      <a id="5184" class="Symbol">)</a>
  <a id="5188" class="Keyword">where</a>
    <a id="5198" class="Keyword">open</a> <a id="5203" href="Ledger.Transaction.html#4647" class="Module">Tx</a> <a id="5206" href="Ledger.Utxo.html#4859" class="Bound">tx</a><a id="5208" class="Symbol">;</a> <a id="5210" class="Keyword">open</a> <a id="5215" href="Ledger.Transaction.html#3692" class="Module">TxBody</a> <a id="5222" href="Ledger.Transaction.html#4672" class="Function">body</a><a id="5226" class="Symbol">;</a> <a id="5228" class="Keyword">open</a> <a id="5233" href="Ledger.Transaction.html#4392" class="Module">TxWitnesses</a> <a id="5245" href="Ledger.Transaction.html#4700" class="Function">wits</a><a id="5249" class="Symbol">;</a> <a id="5251" class="Keyword">open</a> <a id="5256" href="Ledger.PParams.html#1143" class="Module">PParams</a> <a id="5264" href="Ledger.Utxo.html#4856" class="Bound">pp</a>
    <a id="5271" href="Ledger.Utxo.html#5271" class="Function">collateralRange</a> <a id="5287" class="Symbol">=</a> <a id="5289" href="Interface.IsSet.html#837" class="Function">range</a> <a id="5295" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5297" class="Symbol">(</a><a id="5298" href="Ledger.Utxo.html#4862" class="Bound">utxo</a> <a id="5303" href="Axiom.Set.Map.html#9287" class="Function Operator">∣</a> <a id="5305" href="Ledger.Transaction.html#4277" class="Function">collateral</a><a id="5315" class="Symbol">)</a> <a id="5317" class="Symbol">.</a><a id="5318" href="Data.Product.Base.html#608" class="Field">proj₁</a>
    <a id="5328" href="Ledger.Utxo.html#5328" class="Function">bal</a>             <a id="5344" class="Symbol">=</a> <a id="5346" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="5354" class="Symbol">(</a><a id="5355" href="Ledger.Utxo.html#4862" class="Bound">utxo</a> <a id="5360" href="Axiom.Set.Map.html#9287" class="Function Operator">∣</a> <a id="5362" href="Ledger.Transaction.html#4277" class="Function">collateral</a><a id="5372" class="Symbol">)</a>
<a id="5374" class="Markup">\end{code}</a><a id="5384" class="Background">
</a><a id="5385" class="Markup">\begin{code}[hide]</a>
<a id="5404" class="Keyword">instance</a>
  <a id="5415" class="Keyword">unquoteDecl</a> <a id="DecEq-DepositPurpose"></a><a id="5427" href="Ledger.Utxo.html#5427" class="Function">DecEq-DepositPurpose</a> <a id="5448" class="Symbol">=</a> <a id="5450" href="Tactic.Derive.DecEq.html#3471" class="Function">derive-DecEq</a>
    <a id="5467" class="Symbol">((</a><a id="5469" class="Keyword">quote</a> <a id="5475" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="5490" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5492" href="Ledger.Utxo.html#5427" class="Function">DecEq-DepositPurpose</a><a id="5512" class="Symbol">)</a> <a id="5514" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5516" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5518" class="Symbol">)</a>

  <a id="HasCoin-UTxO"></a><a id="5523" href="Ledger.Utxo.html#5523" class="Function">HasCoin-UTxO</a> <a id="5536" class="Symbol">:</a> <a id="5538" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="5546" href="Ledger.Transaction.html#3286" class="Function">UTxO</a>
  <a id="5553" href="Ledger.Utxo.html#5523" class="Function">HasCoin-UTxO</a> <a id="5566" class="Symbol">.</a><a id="5567" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="5575" class="Symbol">=</a> <a id="5577" href="Ledger.Utxo.html#2305" class="Function">cbalance</a>
<a id="5586" class="Markup">\end{code}</a><a id="5596" class="Background">

\caption{Functions used in UTxO rules}
\label{fig:functions:utxo}
\end{figure*}

\AgdaTarget{UTxOEnv, UTxOState, \_⊢\_⇀⦇\_,UTXO⦈\_}
\begin{figure*}[h]
\emph{Derived types}
</a><a id="5770" class="Markup">\begin{code}</a>
<a id="Deposits"></a><a id="5783" href="Ledger.Utxo.html#5783" class="Function">Deposits</a> <a id="5792" class="Symbol">=</a> <a id="5794" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="5809" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="5811" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="5816" class="Markup">\end{code}</a><a id="5826" class="Background">
\emph{UTxO environment}
</a><a id="5851" class="Markup">\begin{code}</a>
<a id="5864" class="Keyword">record</a> <a id="UTxOEnv"></a><a id="5871" href="Ledger.Utxo.html#5871" class="Record">UTxOEnv</a> <a id="5879" class="Symbol">:</a> <a id="5881" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="5885" class="Keyword">where</a>
  <a id="5893" class="Keyword">field</a> <a id="UTxOEnv.slot"></a><a id="5899" href="Ledger.Utxo.html#5899" class="Field">slot</a>     <a id="5908" class="Symbol">:</a> <a id="5910" href="Ledger.Epoch.html#341" class="Function">Slot</a>
        <a id="UTxOEnv.ppolicy"></a><a id="5923" href="Ledger.Utxo.html#5923" class="Field">ppolicy</a>  <a id="5932" class="Symbol">:</a> <a id="5934" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="5940" href="Ledger.Crypto.html#1595" class="Function">ScriptHash</a>
        <a id="UTxOEnv.pparams"></a><a id="5959" href="Ledger.Utxo.html#5959" class="Field">pparams</a>  <a id="5968" class="Symbol">:</a> <a id="5970" href="Ledger.PParams.html#1143" class="Record">PParams</a>
<a id="5978" class="Markup">\end{code}</a><a id="5988" class="Background">
\emph{UTxO states}
</a><a id="6008" class="Markup">\begin{code}</a>
<a id="6021" class="Keyword">record</a> <a id="UTxOState"></a><a id="6028" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="6038" class="Symbol">:</a> <a id="6040" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="6044" class="Keyword">where</a>
  <a id="6052" class="Keyword">constructor</a> <a id="⟦_,_,_,_⟧ᵘ"></a><a id="6064" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">⟦_,_,_,_⟧ᵘ</a>
  <a id="6077" class="Keyword">field</a> <a id="UTxOState.utxo"></a><a id="6083" href="Ledger.Utxo.html#6083" class="Field">utxo</a>       <a id="6094" class="Symbol">:</a> <a id="6096" href="Ledger.Transaction.html#3286" class="Function">UTxO</a>
        <a id="UTxOState.fees"></a><a id="6109" href="Ledger.Utxo.html#6109" class="Field">fees</a>       <a id="6120" class="Symbol">:</a> <a id="6122" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
        <a id="UTxOState.deposits"></a><a id="6135" href="Ledger.Utxo.html#6135" class="Field">deposits</a>   <a id="6146" class="Symbol">:</a> <a id="6148" href="Ledger.Utxo.html#5783" class="Function">Deposits</a>
        <a id="UTxOState.donations"></a><a id="6165" href="Ledger.Utxo.html#6165" class="Field">donations</a>  <a id="6176" class="Symbol">:</a> <a id="6178" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="6183" class="Markup">\end{code}</a><a id="6193" class="Background">
\emph{UTxO transitions}

</a><a id="6219" class="Markup">\begin{code}[hide]</a>
<a id="⟦_⟧"></a><a id="6238" href="Ledger.Utxo.html#6238" class="Function Operator">⟦_⟧</a> <a id="6242" class="Symbol">:</a> <a id="6244" class="Symbol">{</a><a id="6245" href="Ledger.Utxo.html#6245" class="Bound">A</a> <a id="6247" class="Symbol">:</a> <a id="6249" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="6252" class="Symbol">}</a> <a id="6254" class="Symbol">→</a> <a id="6256" href="Ledger.Utxo.html#6245" class="Bound">A</a> <a id="6258" class="Symbol">→</a> <a id="6260" href="Ledger.Utxo.html#6245" class="Bound">A</a>
<a id="6262" href="Ledger.Utxo.html#6238" class="Function Operator">⟦_⟧</a> <a id="6266" class="Symbol">=</a> <a id="6268" href="Function.Base.html#695" class="Function">id</a>

<a id="6272" class="Keyword">instance</a>
  <a id="netId?"></a><a id="6283" href="Ledger.Utxo.html#6283" class="Function">netId?</a> <a id="6290" class="Symbol">:</a> <a id="6292" class="Symbol">∀</a> <a id="6294" class="Symbol">{</a><a id="6295" href="Ledger.Utxo.html#6295" class="Bound">A</a> <a id="6297" class="Symbol">:</a> <a id="6299" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="6302" class="Symbol">}</a> <a id="6304" class="Symbol">{</a><a id="6305" href="Ledger.Utxo.html#6305" class="Bound">networkId</a> <a id="6315" class="Symbol">:</a> <a id="6317" href="Ledger.Epoch.html#1571" class="Function">Network</a><a id="6324" class="Symbol">}</a> <a id="6326" class="Symbol">{</a><a id="6327" href="Ledger.Utxo.html#6327" class="Bound">f</a> <a id="6329" class="Symbol">:</a> <a id="6331" href="Ledger.Utxo.html#6295" class="Bound">A</a> <a id="6333" class="Symbol">→</a> <a id="6335" href="Ledger.Epoch.html#1571" class="Function">Network</a><a id="6342" class="Symbol">}</a>
    <a id="6348" class="Symbol">→</a> <a id="6350" href="Interface.Decidable.Instance.html#905" class="Record">Dec₁</a> <a id="6355" class="Symbol">(λ</a> <a id="6358" href="Ledger.Utxo.html#6358" class="Bound">a</a> <a id="6360" class="Symbol">→</a> <a id="6362" href="Ledger.Utxo.html#6327" class="Bound">f</a> <a id="6364" href="Ledger.Utxo.html#6358" class="Bound">a</a> <a id="6366" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6368" href="Ledger.Utxo.html#6305" class="Bound">networkId</a><a id="6377" class="Symbol">)</a>
  <a id="6381" href="Ledger.Utxo.html#6283" class="Function">netId?</a> <a id="6388" class="Symbol">{_}</a> <a id="6392" class="Symbol">{</a><a id="6393" href="Ledger.Utxo.html#6393" class="Bound">networkId</a><a id="6402" class="Symbol">}</a> <a id="6404" class="Symbol">{</a><a id="6405" href="Ledger.Utxo.html#6405" class="Bound">f</a><a id="6406" class="Symbol">}</a> <a id="6408" class="Symbol">.</a><a id="6409" href="Interface.Decidable.Instance.html#972" class="Field">Dec₁.P?</a> <a id="6417" href="Ledger.Utxo.html#6417" class="Bound">a</a> <a id="6419" class="Symbol">=</a> <a id="6421" href="Ledger.Utxo.html#6405" class="Bound">f</a> <a id="6423" href="Ledger.Utxo.html#6417" class="Bound">a</a> <a id="6425" href="Interface.DecEq.html#243" class="Field Operator">≟</a> <a id="6427" href="Ledger.Utxo.html#6393" class="Bound">networkId</a>

  <a id="Dec-inInterval"></a><a id="6440" href="Ledger.Utxo.html#6440" class="Function">Dec-inInterval</a> <a id="6455" class="Symbol">:</a> <a id="6457" class="Symbol">{</a><a id="6458" href="Ledger.Utxo.html#6458" class="Bound">slot</a> <a id="6463" class="Symbol">:</a> <a id="6465" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="6469" class="Symbol">}</a> <a id="6471" class="Symbol">{</a><a id="6472" href="Ledger.Utxo.html#6472" class="Bound">I</a> <a id="6474" class="Symbol">:</a> <a id="6476" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="6482" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="6487" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="6489" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="6495" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="6499" class="Symbol">}</a> <a id="6501" class="Symbol">→</a> <a id="6503" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="6507" class="Symbol">(</a><a id="6508" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="6519" href="Ledger.Utxo.html#6458" class="Bound">slot</a> <a id="6524" href="Ledger.Utxo.html#6472" class="Bound">I</a><a id="6525" class="Symbol">)</a>
  <a id="6529" href="Ledger.Utxo.html#6440" class="Function">Dec-inInterval</a> <a id="6544" class="Symbol">{</a><a id="6545" href="Ledger.Utxo.html#6545" class="Bound">slot</a><a id="6549" class="Symbol">}</a> <a id="6551" class="Symbol">{</a><a id="6552" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="6557" href="Ledger.Utxo.html#6557" class="Bound">x</a>  <a id="6560" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6562" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="6567" href="Ledger.Utxo.html#6567" class="Bound">y</a> <a id="6569" class="Symbol">}</a> <a id="6571" class="Keyword">with</a> <a id="6576" href="Ledger.Utxo.html#6557" class="Bound">x</a> <a id="6578" href="Interface.HasOrder.html#616" class="Function Operator">≤?</a> <a id="6581" href="Ledger.Utxo.html#6545" class="Bound">slot</a> <a id="6586" class="Symbol">|</a> <a id="6588" href="Ledger.Utxo.html#6545" class="Bound">slot</a> <a id="6593" href="Interface.HasOrder.html#616" class="Function Operator">≤?</a> <a id="6596" href="Ledger.Utxo.html#6567" class="Bound">y</a>
  <a id="6600" class="Symbol">...</a> <a id="6604" class="Symbol">|</a> <a id="6606" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6609" href="Ledger.Utxo.html#6609" class="Bound">¬p₁</a> <a id="6613" class="Symbol">|</a> <a id="6615" class="Symbol">_</a>      <a id="6622" class="Symbol">=</a> <a id="6624" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6627" class="Symbol">λ</a> <a id="6629" class="Keyword">where</a> <a id="6635" class="Symbol">(</a><a id="6636" href="Ledger.Utxo.html#4091" class="InductiveConstructor">both</a> <a id="6641" class="Symbol">(</a><a id="6642" href="Ledger.Utxo.html#6642" class="Bound">h₁</a> <a id="6645" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6647" href="Ledger.Utxo.html#6647" class="Bound">h₂</a><a id="6649" class="Symbol">))</a> <a id="6652" class="Symbol">→</a> <a id="6654" href="Ledger.Utxo.html#6609" class="Bound">¬p₁</a> <a id="6658" href="Ledger.Utxo.html#6642" class="Bound">h₁</a>
  <a id="6663" class="Symbol">...</a> <a id="6667" class="Symbol">|</a> <a id="6669" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6673" href="Ledger.Utxo.html#6673" class="Bound">p₁</a> <a id="6676" class="Symbol">|</a> <a id="6678" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6681" href="Ledger.Utxo.html#6681" class="Bound">¬p₂</a> <a id="6685" class="Symbol">=</a> <a id="6687" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6690" class="Symbol">λ</a> <a id="6692" class="Keyword">where</a> <a id="6698" class="Symbol">(</a><a id="6699" href="Ledger.Utxo.html#4091" class="InductiveConstructor">both</a> <a id="6704" class="Symbol">(</a><a id="6705" href="Ledger.Utxo.html#6705" class="Bound">h₁</a> <a id="6708" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6710" href="Ledger.Utxo.html#6710" class="Bound">h₂</a><a id="6712" class="Symbol">))</a> <a id="6715" class="Symbol">→</a> <a id="6717" href="Ledger.Utxo.html#6681" class="Bound">¬p₂</a> <a id="6721" href="Ledger.Utxo.html#6710" class="Bound">h₂</a>
  <a id="6726" class="Symbol">...</a> <a id="6730" class="Symbol">|</a> <a id="6732" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6736" href="Ledger.Utxo.html#6736" class="Bound">p₁</a> <a id="6739" class="Symbol">|</a> <a id="6741" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6745" href="Ledger.Utxo.html#6745" class="Bound">p₂</a> <a id="6748" class="Symbol">=</a> <a id="6750" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6754" class="Symbol">(</a><a id="6755" href="Ledger.Utxo.html#4091" class="InductiveConstructor">both</a> <a id="6760" class="Symbol">(</a><a id="6761" href="Ledger.Utxo.html#6736" class="Bound">p₁</a> <a id="6764" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6766" href="Ledger.Utxo.html#6745" class="Bound">p₂</a><a id="6768" class="Symbol">))</a>
  <a id="6773" href="Ledger.Utxo.html#6440" class="Function">Dec-inInterval</a> <a id="6788" class="Symbol">{</a><a id="6789" href="Ledger.Utxo.html#6789" class="Bound">slot</a><a id="6793" class="Symbol">}</a> <a id="6795" class="Symbol">{</a><a id="6796" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="6801" href="Ledger.Utxo.html#6801" class="Bound">x</a>  <a id="6804" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6806" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="6813" class="Symbol">}</a> <a id="6815" class="Keyword">with</a> <a id="6820" href="Ledger.Utxo.html#6801" class="Bound">x</a> <a id="6822" href="Interface.HasOrder.html#616" class="Function Operator">≤?</a> <a id="6825" href="Ledger.Utxo.html#6789" class="Bound">slot</a>
  <a id="6832" class="Symbol">...</a> <a id="6836" class="Symbol">|</a> <a id="6838" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6841" href="Ledger.Utxo.html#6841" class="Bound">¬p</a> <a id="6844" class="Symbol">=</a> <a id="6846" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a>  <a id="6850" class="Symbol">(λ</a> <a id="6853" class="Keyword">where</a> <a id="6859" class="Symbol">(</a><a id="6860" href="Ledger.Utxo.html#4173" class="InductiveConstructor">lower</a> <a id="6866" href="Ledger.Utxo.html#6866" class="Bound">h</a><a id="6867" class="Symbol">)</a> <a id="6869" class="Symbol">→</a> <a id="6871" href="Ledger.Utxo.html#6841" class="Bound">¬p</a> <a id="6874" href="Ledger.Utxo.html#6866" class="Bound">h</a><a id="6875" class="Symbol">)</a>
  <a id="6879" class="Symbol">...</a> <a id="6883" class="Symbol">|</a> <a id="6885" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6889" href="Ledger.Utxo.html#6889" class="Bound">p</a> <a id="6891" class="Symbol">=</a> <a id="6893" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="6897" class="Symbol">(</a><a id="6898" href="Ledger.Utxo.html#4173" class="InductiveConstructor">lower</a> <a id="6904" href="Ledger.Utxo.html#6889" class="Bound">p</a><a id="6905" class="Symbol">)</a>
  <a id="6909" href="Ledger.Utxo.html#6440" class="Function">Dec-inInterval</a> <a id="6924" class="Symbol">{</a><a id="6925" href="Ledger.Utxo.html#6925" class="Bound">slot</a><a id="6929" class="Symbol">}</a> <a id="6931" class="Symbol">{</a><a id="6932" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="6940" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6942" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="6947" href="Ledger.Utxo.html#6947" class="Bound">x</a> <a id="6949" class="Symbol">}</a> <a id="6951" class="Keyword">with</a> <a id="6956" href="Ledger.Utxo.html#6925" class="Bound">slot</a> <a id="6961" href="Interface.HasOrder.html#616" class="Function Operator">≤?</a> <a id="6964" href="Ledger.Utxo.html#6947" class="Bound">x</a>
  <a id="6968" class="Symbol">...</a> <a id="6972" class="Symbol">|</a> <a id="6974" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="6977" href="Ledger.Utxo.html#6977" class="Bound">¬p</a> <a id="6980" class="Symbol">=</a> <a id="6982" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a>  <a id="6986" class="Symbol">(λ</a> <a id="6989" class="Keyword">where</a> <a id="6995" class="Symbol">(</a><a id="6996" href="Ledger.Utxo.html#4256" class="InductiveConstructor">upper</a> <a id="7002" href="Ledger.Utxo.html#7002" class="Bound">h</a><a id="7003" class="Symbol">)</a> <a id="7005" class="Symbol">→</a> <a id="7007" href="Ledger.Utxo.html#6977" class="Bound">¬p</a> <a id="7010" href="Ledger.Utxo.html#7002" class="Bound">h</a><a id="7011" class="Symbol">)</a>
  <a id="7015" class="Symbol">...</a> <a id="7019" class="Symbol">|</a> <a id="7021" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="7025" href="Ledger.Utxo.html#7025" class="Bound">p</a> <a id="7027" class="Symbol">=</a> <a id="7029" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="7033" class="Symbol">(</a><a id="7034" href="Ledger.Utxo.html#4256" class="InductiveConstructor">upper</a> <a id="7040" href="Ledger.Utxo.html#7025" class="Bound">p</a><a id="7041" class="Symbol">)</a>
  <a id="7045" href="Ledger.Utxo.html#6440" class="Function">Dec-inInterval</a> <a id="7060" class="Symbol">{</a><a id="7061" href="Ledger.Utxo.html#7061" class="Bound">slot</a><a id="7065" class="Symbol">}</a> <a id="7067" class="Symbol">{</a><a id="7068" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="7076" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="7078" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="7085" class="Symbol">}</a> <a id="7087" class="Symbol">=</a> <a id="7089" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="7093" href="Ledger.Utxo.html#4338" class="InductiveConstructor">none</a>

  <a id="HasCoin-UTxOState"></a><a id="7101" href="Ledger.Utxo.html#7101" class="Function">HasCoin-UTxOState</a> <a id="7119" class="Symbol">:</a> <a id="7121" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="7129" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a>
  <a id="7141" href="Ledger.Utxo.html#7101" class="Function">HasCoin-UTxOState</a> <a id="7159" class="Symbol">.</a><a id="7160" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="7168" href="Ledger.Utxo.html#7168" class="Bound">s</a> <a id="7170" class="Symbol">=</a> <a id="7172" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="7180" class="Symbol">(</a><a id="7181" href="Ledger.Utxo.html#6083" class="Field">UTxOState.utxo</a> <a id="7196" href="Ledger.Utxo.html#7168" class="Bound">s</a><a id="7197" class="Symbol">)</a>
                               <a id="7230" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="7232" class="Symbol">(</a><a id="7233" href="Ledger.Utxo.html#6109" class="Field">UTxOState.fees</a> <a id="7248" href="Ledger.Utxo.html#7168" class="Bound">s</a><a id="7249" class="Symbol">)</a>
                               <a id="7282" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="7284" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="7292" class="Symbol">(</a><a id="7293" href="Ledger.Utxo.html#6135" class="Field">UTxOState.deposits</a> <a id="7312" href="Ledger.Utxo.html#7168" class="Bound">s</a><a id="7313" class="Symbol">)</a>
                               <a id="7346" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="7348" href="Ledger.Utxo.html#6165" class="Field">UTxOState.donations</a> <a id="7368" href="Ledger.Utxo.html#7168" class="Bound">s</a>
<a id="7370" class="Keyword">data</a>
<a id="7375" class="Markup">\end{code}</a><a id="7385" class="Background">
</a><a id="7386" class="Markup">\begin{code}</a>
  <a id="_⊢_⇀⦇_,UTXO⦈_"></a><a id="7401" href="Ledger.Utxo.html#7401" class="Datatype Operator">_⊢_⇀⦇_,UTXO⦈_</a> <a id="7415" class="Symbol">:</a> <a id="7417" href="Ledger.Utxo.html#5871" class="Record">UTxOEnv</a> <a id="7425" class="Symbol">→</a> <a id="7427" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="7437" class="Symbol">→</a> <a id="7439" href="Ledger.Transaction.html#4647" class="Record">Tx</a> <a id="7442" class="Symbol">→</a> <a id="7444" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="7454" class="Symbol">→</a> <a id="7456" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="7460" class="Markup">\end{code}</a><a id="7470" class="Background">
\caption{UTxO transition-system types}
\label{fig:ts-types:utxo-shelley}
\end{figure*}

\begin{figure*}
</a><a id="7575" class="Markup">\begin{code}[hide]</a>
<a id="7594" class="Keyword">module</a> <a id="7601" href="Ledger.Utxo.html#7601" class="Module">_</a> <a id="7603" class="Symbol">(</a><a id="7604" class="Keyword">let</a> <a id="7608" class="Keyword">open</a> <a id="7613" href="Ledger.Utxo.html#6028" class="Module">UTxOState</a><a id="7622" class="Symbol">;</a> <a id="7624" class="Keyword">open</a> <a id="7629" href="Ledger.Transaction.html#3692" class="Module">TxBody</a><a id="7635" class="Symbol">)</a> <a id="7637" class="Keyword">where</a>
<a id="7643" class="Markup">\end{code}</a><a id="7653" class="Background">
</a><a id="7654" class="Markup">\begin{code}</a>
  <a id="7669" href="Ledger.Utxo.html#7669" class="Function">updateCertDeposits</a> <a id="7688" class="Symbol">:</a> <a id="7690" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="7698" class="Symbol">→</a> <a id="7700" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="7705" href="Ledger.Deleg.html#353" class="Datatype">DCert</a> <a id="7711" class="Symbol">→</a> <a id="7713" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="7728" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="7730" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="7739" class="Symbol">→</a> <a id="7741" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="7756" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="7758" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="7765" href="Ledger.Utxo.html#7669" class="Function">updateCertDeposits</a> <a id="7784" href="Ledger.Utxo.html#7784" class="Bound">pp</a> <a id="7787" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="7790" href="Ledger.Utxo.html#7790" class="Bound">deposits</a> <a id="7799" class="Symbol">=</a> <a id="7801" href="Ledger.Utxo.html#7790" class="Bound">deposits</a>
  <a id="7812" href="Ledger.Utxo.html#7669" class="Function">updateCertDeposits</a> <a id="7831" href="Ledger.Utxo.html#7831" class="Bound">pp</a> <a id="7834" class="Symbol">(</a><a id="7835" href="Ledger.Utxo.html#7835" class="Bound">cert</a> <a id="7840" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="7842" href="Ledger.Utxo.html#7842" class="Bound">certs</a><a id="7847" class="Symbol">)</a> <a id="7849" href="Ledger.Utxo.html#7849" class="Bound">deposits</a>
    <a id="7862" class="Symbol">=</a>  <a id="7865" href="Ledger.Utxo.html#7669" class="Function">updateCertDeposits</a> <a id="7884" href="Ledger.Utxo.html#7831" class="Bound">pp</a> <a id="7887" href="Ledger.Utxo.html#7842" class="Bound">certs</a> <a id="7893" href="Ledger.Utxo.html#7849" class="Bound">deposits</a> <a id="7902" href="Axiom.Set.Map.Dec.html#1841" class="Function Operator">∪⁺</a> <a id="7905" href="Ledger.Utxo.html#3254" class="Function">certDepositᵐ</a> <a id="7918" href="Ledger.Utxo.html#7831" class="Bound">pp</a> <a id="7921" href="Ledger.Utxo.html#7835" class="Bound">cert</a>
    <a id="7930" href="Axiom.Set.Map.html#9357" class="Function Operator">∣</a>  <a id="7933" href="Ledger.Utxo.html#3881" class="Function">certRefundˢ</a> <a id="7945" href="Ledger.Utxo.html#7835" class="Bound">cert</a> <a id="7950" href="Axiom.Set.Map.html#9357" class="Function Operator">ᶜ</a>

  <a id="7955" href="Ledger.Utxo.html#7955" class="Function">updateProposalDeposits</a> <a id="7978" class="Symbol">:</a> <a id="7980" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="7988" class="Symbol">→</a> <a id="7990" href="Ledger.Transaction.html#1781" class="Field">TxId</a> <a id="7995" class="Symbol">→</a> <a id="7997" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="8002" href="Ledger.GovernanceActions.html#8716" class="Record">GovProposal</a> <a id="8014" class="Symbol">→</a> <a id="8016" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="8031" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="8033" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="8042" class="Symbol">→</a> <a id="8044" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="8059" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="8061" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="8068" href="Ledger.Utxo.html#7955" class="Function">updateProposalDeposits</a> <a id="8091" href="Ledger.Utxo.html#8091" class="Bound">pp</a> <a id="8094" href="Ledger.Utxo.html#8094" class="Bound">txid</a> <a id="8099" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="8102" href="Ledger.Utxo.html#8102" class="Bound">deposits</a> <a id="8111" class="Symbol">=</a> <a id="8113" href="Ledger.Utxo.html#8102" class="Bound">deposits</a>
  <a id="8124" href="Ledger.Utxo.html#7955" class="Function">updateProposalDeposits</a> <a id="8147" href="Ledger.Utxo.html#8147" class="Bound">pp</a> <a id="8150" href="Ledger.Utxo.html#8150" class="Bound">txid</a> <a id="8155" class="Symbol">(</a><a id="8156" href="Ledger.Utxo.html#8156" class="Bound">prop</a> <a id="8161" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8163" href="Ledger.Utxo.html#8163" class="Bound">props</a><a id="8168" class="Symbol">)</a> <a id="8170" href="Ledger.Utxo.html#8170" class="Bound">deposits</a>
    <a id="8183" class="Symbol">=</a>   <a id="8187" href="Ledger.Utxo.html#7955" class="Function">updateProposalDeposits</a> <a id="8210" href="Ledger.Utxo.html#8147" class="Bound">pp</a> <a id="8213" href="Ledger.Utxo.html#8150" class="Bound">txid</a> <a id="8218" href="Ledger.Utxo.html#8163" class="Bound">props</a> <a id="8224" href="Ledger.Utxo.html#8170" class="Bound">deposits</a>
    <a id="8237" href="Axiom.Set.Map.Dec.html#1841" class="Function Operator">∪⁺</a>  <a id="8241" href="Ledger.Utxo.html#3431" class="Function">propDepositᵐ</a> <a id="8254" href="Ledger.Utxo.html#8147" class="Bound">pp</a> <a id="8257" class="Symbol">(</a><a id="8258" href="Ledger.Utxo.html#8150" class="Bound">txid</a> <a id="8263" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8265" href="Data.List.Base.html#5058" class="Function">length</a> <a id="8272" href="Ledger.Utxo.html#8163" class="Bound">props</a><a id="8277" class="Symbol">)</a> <a id="8279" href="Ledger.Utxo.html#8156" class="Bound">prop</a>

  <a id="8287" href="Ledger.Utxo.html#8287" class="Function">updateDeposits</a> <a id="8302" class="Symbol">:</a> <a id="8304" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="8312" class="Symbol">→</a> <a id="8314" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="8321" class="Symbol">→</a> <a id="8323" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="8338" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="8340" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="8345" class="Symbol">→</a> <a id="8347" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="8362" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="8364" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="8371" href="Ledger.Utxo.html#8287" class="Function">updateDeposits</a> <a id="8386" href="Ledger.Utxo.html#8386" class="Bound">pp</a> <a id="8389" href="Ledger.Utxo.html#8389" class="Bound">txb</a>
    <a id="8397" class="Symbol">=</a>  <a id="8400" href="Ledger.Utxo.html#7669" class="Function">updateCertDeposits</a> <a id="8419" href="Ledger.Utxo.html#8386" class="Bound">pp</a> <a id="8422" class="Symbol">(</a><a id="8423" href="Ledger.Utxo.html#8389" class="Bound">txb</a> <a id="8427" class="Symbol">.</a><a id="8428" href="Ledger.Transaction.html#3909" class="Field">txcerts</a><a id="8435" class="Symbol">)</a>
    <a id="8441" href="Function.Base.html#1106" class="Function Operator">∘</a>  <a id="8444" href="Ledger.Utxo.html#7955" class="Function">updateProposalDeposits</a> <a id="8467" href="Ledger.Utxo.html#8386" class="Bound">pp</a> <a id="8470" class="Symbol">(</a><a id="8471" href="Ledger.Utxo.html#8389" class="Bound">txb</a> <a id="8475" class="Symbol">.</a><a id="8476" href="Ledger.Transaction.html#4245" class="Field">txid</a><a id="8480" class="Symbol">)</a> <a id="8482" class="Symbol">(</a><a id="8483" href="Ledger.Utxo.html#8389" class="Bound">txb</a> <a id="8487" class="Symbol">.</a><a id="8488" href="Ledger.Transaction.html#4019" class="Field">txprop</a><a id="8494" class="Symbol">)</a>

  <a id="8499" href="Ledger.Utxo.html#8499" class="Function">depositsChange</a> <a id="8514" class="Symbol">:</a> <a id="8516" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="8524" class="Symbol">→</a> <a id="8526" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="8533" class="Symbol">→</a> <a id="8535" href="Ledger.Utxo.html#2664" class="Datatype">DepositPurpose</a> <a id="8550" href="Ledger.Set.Theory.html#1522" class="Function Operator">⇀</a> <a id="8552" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="8557" class="Symbol">→</a> <a id="8559" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="8563" href="Ledger.Utxo.html#8499" class="Function">depositsChange</a> <a id="8578" href="Ledger.Utxo.html#8578" class="Bound">pp</a> <a id="8581" href="Ledger.Utxo.html#8581" class="Bound">txb</a> <a id="8585" href="Ledger.Utxo.html#8585" class="Bound">deposits</a>
    <a id="8598" class="Symbol">=</a>  <a id="8601" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="8609" class="Symbol">(</a><a id="8610" href="Ledger.Utxo.html#8287" class="Function">updateDeposits</a> <a id="8625" href="Ledger.Utxo.html#8578" class="Bound">pp</a> <a id="8628" href="Ledger.Utxo.html#8581" class="Bound">txb</a> <a id="8632" href="Ledger.Utxo.html#8585" class="Bound">deposits</a><a id="8640" class="Symbol">)</a>
    <a id="8646" href="Data.Integer.Base.html#4899" class="Function Operator">⊖</a>  <a id="8649" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="8657" href="Ledger.Utxo.html#8585" class="Bound">deposits</a>

  <a id="8669" href="Ledger.Utxo.html#8669" class="Function">depositRefunds</a> <a id="8684" class="Symbol">:</a> <a id="8686" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="8694" class="Symbol">→</a> <a id="8696" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="8706" class="Symbol">→</a> <a id="8708" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="8715" class="Symbol">→</a> <a id="8717" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="8724" href="Ledger.Utxo.html#8669" class="Function">depositRefunds</a> <a id="8739" href="Ledger.Utxo.html#8739" class="Bound">pp</a> <a id="8742" href="Ledger.Utxo.html#8742" class="Bound">st</a> <a id="8745" href="Ledger.Utxo.html#8745" class="Bound">txb</a> <a id="8749" class="Symbol">=</a> <a id="8751" href="Data.Integer.Ext.html#300" class="Function">negPart</a> <a id="8759" class="Symbol">(</a><a id="8760" href="Ledger.Utxo.html#8499" class="Function">depositsChange</a> <a id="8775" href="Ledger.Utxo.html#8739" class="Bound">pp</a> <a id="8778" href="Ledger.Utxo.html#8745" class="Bound">txb</a> <a id="8782" class="Symbol">(</a><a id="8783" href="Ledger.Utxo.html#8742" class="Bound">st</a> <a id="8786" class="Symbol">.</a><a id="8787" href="Ledger.Utxo.html#6135" class="Field">deposits</a><a id="8795" class="Symbol">))</a>

  <a id="8801" href="Ledger.Utxo.html#8801" class="Function">newDeposits</a> <a id="8813" class="Symbol">:</a> <a id="8815" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="8823" class="Symbol">→</a> <a id="8825" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="8835" class="Symbol">→</a> <a id="8837" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="8844" class="Symbol">→</a> <a id="8846" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="8853" href="Ledger.Utxo.html#8801" class="Function">newDeposits</a> <a id="8865" href="Ledger.Utxo.html#8865" class="Bound">pp</a> <a id="8868" href="Ledger.Utxo.html#8868" class="Bound">st</a> <a id="8871" href="Ledger.Utxo.html#8871" class="Bound">txb</a> <a id="8875" class="Symbol">=</a> <a id="8877" href="Data.Integer.Ext.html#209" class="Function">posPart</a> <a id="8885" class="Symbol">(</a><a id="8886" href="Ledger.Utxo.html#8499" class="Function">depositsChange</a> <a id="8901" href="Ledger.Utxo.html#8865" class="Bound">pp</a> <a id="8904" href="Ledger.Utxo.html#8871" class="Bound">txb</a> <a id="8908" class="Symbol">(</a><a id="8909" href="Ledger.Utxo.html#8868" class="Bound">st</a> <a id="8912" class="Symbol">.</a><a id="8913" href="Ledger.Utxo.html#6135" class="Field">deposits</a><a id="8921" class="Symbol">))</a>

  <a id="8927" href="Ledger.Utxo.html#8927" class="Function">consumed</a> <a id="8936" class="Symbol">:</a> <a id="8938" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="8946" class="Symbol">→</a> <a id="8948" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="8958" class="Symbol">→</a> <a id="8960" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="8967" class="Symbol">→</a> <a id="8969" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="8977" href="Ledger.Utxo.html#8927" class="Function">consumed</a> <a id="8986" href="Ledger.Utxo.html#8986" class="Bound">pp</a> <a id="8989" href="Ledger.Utxo.html#8989" class="Bound">st</a> <a id="8992" href="Ledger.Utxo.html#8992" class="Bound">txb</a>
    <a id="9000" class="Symbol">=</a>  <a id="9003" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="9011" class="Symbol">(</a><a id="9012" href="Ledger.Utxo.html#8989" class="Bound">st</a> <a id="9015" class="Symbol">.</a><a id="9016" href="Ledger.Utxo.html#6083" class="Field">utxo</a> <a id="9021" href="Axiom.Set.Map.html#9287" class="Function Operator">∣</a> <a id="9023" href="Ledger.Utxo.html#8992" class="Bound">txb</a> <a id="9027" class="Symbol">.</a><a id="9028" href="Ledger.Transaction.html#3721" class="Field">txins</a><a id="9033" class="Symbol">)</a>
    <a id="9039" href="Interface.HasAdd.html#135" class="Field Operator">+</a>  <a id="9042" href="Ledger.Utxo.html#8992" class="Bound">txb</a> <a id="9046" class="Symbol">.</a><a id="9047" href="Ledger.Transaction.html#3825" class="Field">mint</a>
    <a id="9056" href="Interface.HasAdd.html#135" class="Field Operator">+</a>  <a id="9059" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="9066" class="Symbol">(</a><a id="9067" href="Ledger.Utxo.html#8669" class="Function">depositRefunds</a> <a id="9082" href="Ledger.Utxo.html#8986" class="Bound">pp</a> <a id="9085" href="Ledger.Utxo.html#8989" class="Bound">st</a> <a id="9088" href="Ledger.Utxo.html#8992" class="Bound">txb</a><a id="9091" class="Symbol">)</a>

  <a id="9096" href="Ledger.Utxo.html#9096" class="Function">produced</a> <a id="9105" class="Symbol">:</a> <a id="9107" href="Ledger.PParams.html#1143" class="Record">PParams</a> <a id="9115" class="Symbol">→</a> <a id="9117" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a> <a id="9127" class="Symbol">→</a> <a id="9129" href="Ledger.Transaction.html#3692" class="Record">TxBody</a> <a id="9136" class="Symbol">→</a> <a id="9138" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="9146" href="Ledger.Utxo.html#9096" class="Function">produced</a> <a id="9155" href="Ledger.Utxo.html#9155" class="Bound">pp</a> <a id="9158" href="Ledger.Utxo.html#9158" class="Bound">st</a> <a id="9161" href="Ledger.Utxo.html#9161" class="Bound">txb</a>
    <a id="9169" class="Symbol">=</a>  <a id="9172" href="Ledger.Utxo.html#2232" class="Function">balance</a> <a id="9180" class="Symbol">(</a><a id="9181" href="Ledger.Utxo.html#2161" class="Function">outs</a> <a id="9186" href="Ledger.Utxo.html#9161" class="Bound">txb</a><a id="9189" class="Symbol">)</a>
    <a id="9195" href="Interface.HasAdd.html#135" class="Field Operator">+</a>  <a id="9198" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="9205" class="Symbol">(</a><a id="9206" href="Ledger.Utxo.html#9161" class="Bound">txb</a> <a id="9210" class="Symbol">.</a><a id="9211" href="Ledger.Transaction.html#3793" class="Field">txfee</a><a id="9216" class="Symbol">)</a>
    <a id="9222" href="Interface.HasAdd.html#135" class="Field Operator">+</a>  <a id="9225" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="9232" class="Symbol">(</a><a id="9233" href="Ledger.Utxo.html#8801" class="Function">newDeposits</a> <a id="9245" href="Ledger.Utxo.html#9155" class="Bound">pp</a> <a id="9248" href="Ledger.Utxo.html#9158" class="Bound">st</a> <a id="9251" href="Ledger.Utxo.html#9161" class="Bound">txb</a><a id="9254" class="Symbol">)</a>
    <a id="9260" href="Interface.HasAdd.html#135" class="Field Operator">+</a>  <a id="9263" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="9270" class="Symbol">(</a><a id="9271" href="Ledger.Utxo.html#9161" class="Bound">txb</a> <a id="9275" class="Symbol">.</a><a id="9276" href="Ledger.Transaction.html#4063" class="Field">txdonation</a><a id="9286" class="Symbol">)</a>
<a id="9288" class="Markup">\end{code}</a><a id="9298" class="Background">
\caption{Functions used in UTxO rules, continued}
\label{fig:functions:utxo-2}
\end{figure*}

\begin{figure*}[h]
</a><a id="9412" class="Markup">\begin{code}[hide]</a>
<a id="9431" class="Keyword">open</a> <a id="9436" href="Ledger.PParams.html#1143" class="Module">PParams</a>

<a id="9445" class="Keyword">private</a> <a id="9453" class="Keyword">variable</a>
  <a id="9464" href="Ledger.Utxo.html#9464" class="Generalizable">Γ</a> <a id="9466" class="Symbol">:</a> <a id="9468" href="Ledger.Utxo.html#5871" class="Record">UTxOEnv</a>
  <a id="9478" href="Ledger.Utxo.html#9478" class="Generalizable">s</a> <a id="9480" class="Symbol">:</a> <a id="9482" href="Ledger.Utxo.html#6028" class="Record">UTxOState</a>
  <a id="9494" href="Ledger.Utxo.html#9494" class="Generalizable">tx</a> <a id="9497" class="Symbol">:</a> <a id="9499" href="Ledger.Transaction.html#4647" class="Record">Tx</a>

<a id="9503" class="Keyword">data</a> <a id="9508" href="Ledger.Utxo.html#7401" class="Datatype Operator">_⊢_⇀⦇_,UTXO⦈_</a> <a id="9522" class="Keyword">where</a>
<a id="9528" class="Markup">\end{code}</a><a id="9538" class="Background">
</a><a id="9539" class="Markup">\begin{code}</a>
  <a id="_⊢_⇀⦇_,UTXO⦈_.UTXO-inductive"></a><a id="9554" href="Ledger.Utxo.html#9554" class="InductiveConstructor">UTXO-inductive</a> <a id="9569" class="Symbol">:</a>
    <a id="9575" class="Keyword">let</a> <a id="9579" class="Keyword">open</a> <a id="9584" href="Ledger.Transaction.html#4647" class="Module">Tx</a> <a id="9587" href="Ledger.Utxo.html#9494" class="Generalizable">tx</a> <a id="9590" class="Keyword">renaming</a> <a id="9599" class="Symbol">(</a><a id="9600" href="Ledger.Transaction.html#4672" class="Field">body</a> <a id="9605" class="Symbol">to</a> <a id="9608" class="Field">txb</a><a id="9611" class="Symbol">);</a> <a id="9614" class="Keyword">open</a> <a id="9619" href="Ledger.Transaction.html#3692" class="Module">TxBody</a> <a id="9626" href="Ledger.Utxo.html#9608" class="Function">txb</a>
        <a id="9638" class="Keyword">open</a> <a id="9643" href="Ledger.Utxo.html#5871" class="Module">UTxOEnv</a> <a id="9651" href="Ledger.Utxo.html#9464" class="Generalizable">Γ</a> <a id="9653" class="Keyword">renaming</a> <a id="9662" class="Symbol">(</a><a id="9663" href="Ledger.Utxo.html#5959" class="Field">pparams</a> <a id="9671" class="Symbol">to</a> <a id="9674" class="Field">pp</a><a id="9676" class="Symbol">)</a>
        <a id="9686" class="Keyword">open</a> <a id="9691" href="Ledger.Utxo.html#6028" class="Module">UTxOState</a> <a id="9701" href="Ledger.Utxo.html#9478" class="Generalizable">s</a>
    <a id="9707" class="Keyword">in</a>
       <a id="9717" href="Ledger.Transaction.html#3721" class="Function">txins</a> <a id="9723" href="Relation.Binary.PropositionalEquality.Core.html#844" class="Function Operator">≢</a> <a id="9725" href="Axiom.Set.html#5746" class="Function">∅</a>                              <a id="9756" class="Symbol">→</a> <a id="9758" href="Ledger.Transaction.html#3721" class="Function">txins</a> <a id="9764" href="Axiom.Set.html#1697" class="Function Operator">⊆</a> <a id="9766" href="Interface.IsSet.html#794" class="Function">dom</a> <a id="9770" href="Ledger.Utxo.html#6083" class="Function">utxo</a>
    <a id="9779" class="Symbol">→</a>  <a id="9782" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="9793" href="Ledger.Utxo.html#5899" class="Function">slot</a> <a id="9798" href="Ledger.Transaction.html#3858" class="Function">txvldt</a>                 <a id="9821" class="Symbol">→</a> <a id="9823" href="Ledger.Utxo.html#2517" class="Function">minfee</a> <a id="9830" href="Ledger.Utxo.html#9674" class="Function">pp</a> <a id="9833" href="Ledger.Utxo.html#9494" class="Generalizable">tx</a> <a id="9836" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="9838" href="Ledger.Transaction.html#3793" class="Function">txfee</a>
    <a id="9848" class="Symbol">→</a>  <a id="9851" href="Ledger.Utxo.html#8927" class="Function">consumed</a> <a id="9860" href="Ledger.Utxo.html#9674" class="Function">pp</a> <a id="9863" href="Ledger.Utxo.html#9478" class="Generalizable">s</a> <a id="9865" href="Ledger.Utxo.html#9608" class="Function">txb</a> <a id="9869" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="9871" href="Ledger.Utxo.html#9096" class="Function">produced</a> <a id="9880" href="Ledger.Utxo.html#9674" class="Function">pp</a> <a id="9883" href="Ledger.Utxo.html#9478" class="Generalizable">s</a> <a id="9885" href="Ledger.Utxo.html#9608" class="Function">txb</a>  <a id="9890" class="Symbol">→</a> <a id="9892" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="9897" href="Ledger.Transaction.html#3825" class="Function">mint</a> <a id="9902" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="9904" class="Number">0</a>
    <a id="9910" class="Symbol">→</a>  <a id="9913" href="Ledger.Transaction.html#4216" class="Function">txsize</a> <a id="9920" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="9922" href="Ledger.PParams.html#1323" class="Field">maxTxSize</a> <a id="9932" href="Ledger.Utxo.html#9674" class="Function">pp</a>

    <a id="9940" class="Symbol">→</a> <a id="9942" href="Interface.IsSet.html#611" class="Function">∀[</a> <a id="9945" href="Ledger.Utxo.html#9945" class="Bound">(_</a> <a id="9948" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9950" href="Ledger.Utxo.html#9950" class="Bound">txout</a><a id="9955" href="Ledger.Utxo.html#9945" class="Bound">)</a> <a id="9957" href="Interface.IsSet.html#611" class="Function">∈</a> <a id="9959" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="9966" class="Symbol">.</a><a id="9967" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="9973" href="Interface.IsSet.html#611" class="Function">]</a>
        <a id="9983" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="9990" class="Symbol">(</a><a id="9991" href="Ledger.Utxo.html#1328" class="Function">utxoEntrySize</a> <a id="10005" href="Ledger.Utxo.html#9950" class="Bound">txout</a> <a id="10011" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="10013" href="Ledger.PParams.html#1631" class="Field">minUTxOValue</a> <a id="10026" href="Ledger.Utxo.html#9674" class="Function">pp</a><a id="10028" class="Symbol">)</a> <a id="10030" href="Ledger.TokenAlgebra.html#1140" class="Function Operator">≤ᵗ</a> <a id="10033" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="10042" href="Ledger.Utxo.html#9950" class="Bound">txout</a>
    <a id="10052" class="Symbol">→</a> <a id="10054" href="Interface.IsSet.html#611" class="Function">∀[</a> <a id="10057" href="Ledger.Utxo.html#10057" class="Bound">(_</a> <a id="10060" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="10062" href="Ledger.Utxo.html#10062" class="Bound">txout</a><a id="10067" href="Ledger.Utxo.html#10057" class="Bound">)</a> <a id="10069" href="Interface.IsSet.html#611" class="Function">∈</a> <a id="10071" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="10078" class="Symbol">.</a><a id="10079" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="10085" href="Interface.IsSet.html#611" class="Function">]</a>
        <a id="10095" href="Ledger.Abstract.html#521" class="Field">serSize</a> <a id="10103" class="Symbol">(</a><a id="10104" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="10113" href="Ledger.Utxo.html#10062" class="Bound">txout</a><a id="10118" class="Symbol">)</a> <a id="10120" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="10122" href="Ledger.PParams.html#1385" class="Field">maxValSize</a> <a id="10133" href="Ledger.Utxo.html#9674" class="Function">pp</a>
    <a id="10140" class="Symbol">→</a> <a id="10142" href="Interface.IsSet.html#611" class="Function">∀[</a> <a id="10145" href="Ledger.Utxo.html#10145" class="Bound">(</a><a id="10146" href="Ledger.Utxo.html#10146" class="Bound">a</a> <a id="10148" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="10150" href="Ledger.Utxo.html#10145" class="Bound">_)</a> <a id="10153" href="Interface.IsSet.html#611" class="Function">∈</a> <a id="10155" href="Interface.IsSet.html#837" class="Function">range</a> <a id="10161" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="10168" href="Interface.IsSet.html#611" class="Function">]</a>
        <a id="10178" href="Data.Sum.Relation.Unary.All.html#617" class="Datatype">Sum.All</a> <a id="10186" class="Symbol">(</a><a id="10187" href="Function.Base.html#716" class="Function">const</a> <a id="10193" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a><a id="10194" class="Symbol">)</a> <a id="10196" class="Symbol">(λ</a> <a id="10199" href="Ledger.Utxo.html#10199" class="Bound">a</a> <a id="10201" class="Symbol">→</a> <a id="10203" href="Ledger.Utxo.html#10199" class="Bound">a</a> <a id="10205" class="Symbol">.</a><a id="10206" href="Ledger.Address.html#1193" class="Field">BootstrapAddr.attrsSize</a> <a id="10230" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="10232" class="Number">64</a><a id="10234" class="Symbol">)</a> <a id="10236" href="Ledger.Utxo.html#10146" class="Bound">a</a>
    <a id="10242" class="Symbol">→</a> <a id="10244" href="Interface.IsSet.html#611" class="Function">∀[</a> <a id="10247" href="Ledger.Utxo.html#10247" class="Bound">(</a><a id="10248" href="Ledger.Utxo.html#10248" class="Bound">a</a> <a id="10250" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="10252" href="Ledger.Utxo.html#10247" class="Bound">_)</a> <a id="10255" href="Interface.IsSet.html#611" class="Function">∈</a> <a id="10257" href="Interface.IsSet.html#837" class="Function">range</a> <a id="10263" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="10270" href="Interface.IsSet.html#611" class="Function">]</a> <a id="10272" href="Ledger.Address.html#1992" class="Function">netId</a> <a id="10278" href="Ledger.Utxo.html#10248" class="Bound">a</a>        <a id="10287" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="10289" href="Ledger.Transaction.html#2707" class="Field">networkId</a>
    <a id="10303" class="Symbol">→</a> <a id="10305" href="Interface.IsSet.html#611" class="Function">∀[</a> <a id="10308" href="Ledger.Utxo.html#10308" class="Bound">a</a> <a id="10310" href="Interface.IsSet.html#611" class="Function">∈</a> <a id="10312" href="Interface.IsSet.html#794" class="Function">dom</a>  <a id="10317" href="Ledger.Transaction.html#3947" class="Function">txwdrls</a> <a id="10325" href="Interface.IsSet.html#611" class="Function">]</a>       <a id="10333" href="Ledger.Utxo.html#10308" class="Bound">a</a> <a id="10335" class="Symbol">.</a><a id="10336" href="Ledger.Address.html#1244" class="Field">RwdAddr.net</a> <a id="10348" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="10350" href="Ledger.Transaction.html#2707" class="Field">networkId</a>
    <a id="10364" class="Comment">-- Add deposits</a>

       <a id="10388" href="Interface.STS.html#244" class="Function Operator">────────────────────────────────</a>
       <a id="10428" href="Ledger.Utxo.html#9464" class="Generalizable">Γ</a> <a id="10430" href="Ledger.Utxo.html#7401" class="Datatype Operator">⊢</a> <a id="10432" href="Ledger.Utxo.html#9478" class="Generalizable">s</a> <a id="10434" href="Ledger.Utxo.html#7401" class="Datatype Operator">⇀⦇</a> <a id="10437" href="Ledger.Utxo.html#9494" class="Generalizable">tx</a> <a id="10440" href="Ledger.Utxo.html#7401" class="Datatype Operator">,UTXO⦈</a>  <a id="10448" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">⟦</a> <a id="10450" class="Symbol">(</a><a id="10451" href="Ledger.Utxo.html#6083" class="Function">utxo</a> <a id="10456" href="Axiom.Set.Map.html#9357" class="Function Operator">∣</a> <a id="10458" href="Ledger.Transaction.html#3721" class="Function">txins</a> <a id="10464" href="Axiom.Set.Map.html#9357" class="Function Operator">ᶜ</a><a id="10465" class="Symbol">)</a> <a id="10467" href="Axiom.Set.Map.html#4924" class="Function Operator">∪ᵐˡ</a> <a id="10471" class="Symbol">(</a><a id="10472" href="Ledger.Utxo.html#2161" class="Function">outs</a> <a id="10477" href="Ledger.Utxo.html#9608" class="Function">txb</a><a id="10480" class="Symbol">)</a>
                           <a id="10509" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">,</a> <a id="10511" href="Ledger.Utxo.html#6109" class="Function">fees</a> <a id="10516" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="10518" href="Ledger.Transaction.html#3793" class="Function">txfee</a>
                           <a id="10551" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">,</a> <a id="10553" href="Ledger.Utxo.html#8287" class="Function">updateDeposits</a> <a id="10568" href="Ledger.Utxo.html#9674" class="Function">pp</a> <a id="10571" href="Ledger.Utxo.html#9608" class="Function">txb</a> <a id="10575" href="Ledger.Utxo.html#6135" class="Function">deposits</a>
                           <a id="10611" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">,</a> <a id="10613" href="Ledger.Utxo.html#6165" class="Function">donations</a> <a id="10623" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="10625" href="Ledger.Transaction.html#4063" class="Function">txdonation</a>
                           <a id="10663" href="Ledger.Utxo.html#6064" class="InductiveConstructor Operator">⟧ᵘ</a>

<a id="10667" class="Markup">\end{code}</a><a id="10677" class="Background">
</a><a id="10678" class="Markup">\begin{code}[hide]</a>
<a id="10697" class="Keyword">instance</a>
  <a id="Computational-UTXO"></a><a id="10708" href="Ledger.Utxo.html#10708" class="Function">Computational-UTXO</a> <a id="10727" class="Symbol">:</a> <a id="10729" href="Interface.ComputationalRelation.html#627" class="Record">Computational</a> <a id="10743" href="Ledger.Utxo.html#7401" class="Datatype Operator">_⊢_⇀⦇_,UTXO⦈_</a>
  <a id="10759" href="Ledger.Utxo.html#10708" class="Function">Computational-UTXO</a> <a id="10778" class="Symbol">=</a> <a id="10780" class="Keyword">record</a> <a id="10787" class="Symbol">{</a><a id="10788" href="Ledger.Utxo.html#10805" class="Module">go</a><a id="10790" class="Symbol">}</a> <a id="10792" class="Keyword">where</a> <a id="10798" class="Keyword">module</a> <a id="10805" href="Ledger.Utxo.html#10805" class="Module">go</a> <a id="10808" href="Ledger.Utxo.html#10808" class="Bound">Γ</a> <a id="10810" href="Ledger.Utxo.html#10810" class="Bound">s</a> <a id="10812" href="Ledger.Utxo.html#10812" class="Bound">tx</a> <a id="10815" class="Keyword">where</a>
    <a id="10825" class="Keyword">open</a> <a id="10830" href="Ledger.Transaction.html#4647" class="Module">Tx</a> <a id="10833" href="Ledger.Utxo.html#10812" class="Bound">tx</a> <a id="10836" class="Keyword">renaming</a> <a id="10845" class="Symbol">(</a><a id="10846" href="Ledger.Transaction.html#4672" class="Field">body</a> <a id="10851" class="Symbol">to</a> <a id="10854" class="Field">txb</a><a id="10857" class="Symbol">);</a> <a id="10860" class="Keyword">open</a> <a id="10865" href="Ledger.Transaction.html#3692" class="Module">TxBody</a> <a id="10872" href="Ledger.Utxo.html#10854" class="Field">txb</a>
    <a id="10880" class="Keyword">open</a> <a id="10885" href="Ledger.Utxo.html#5871" class="Module">UTxOEnv</a> <a id="10893" href="Ledger.Utxo.html#10808" class="Bound">Γ</a> <a id="10895" class="Keyword">renaming</a> <a id="10904" class="Symbol">(</a><a id="10905" href="Ledger.Utxo.html#5959" class="Field">pparams</a> <a id="10913" class="Symbol">to</a> <a id="10916" class="Field">pp</a><a id="10918" class="Symbol">)</a>
    <a id="10924" class="Keyword">open</a> <a id="10929" href="Ledger.Utxo.html#6028" class="Module">UTxOState</a> <a id="10939" href="Ledger.Utxo.html#10810" class="Bound">s</a>

    <a id="10946" href="Ledger.Utxo.html#10946" class="Function">UTXO-premises</a> <a id="10960" class="Symbol">:</a> <a id="10962" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="10970" href="Ledger.Utxo.html#10946" class="Function">UTXO-premises</a>
      <a id="10990" class="Symbol">=</a> <a id="10992" href="Ledger.Transaction.html#3721" class="Function">txins</a> <a id="10998" href="Relation.Binary.PropositionalEquality.Core.html#844" class="Function Operator">≢</a> <a id="11000" href="Axiom.Set.html#5746" class="Function">∅</a>
      <a id="11008" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11010" href="Ledger.Transaction.html#3721" class="Function">txins</a> <a id="11016" href="Axiom.Set.html#1697" class="Function Operator">⊆</a> <a id="11018" href="Interface.IsSet.html#794" class="Function">dom</a> <a id="11022" href="Ledger.Utxo.html#6083" class="Function">utxo</a>
      <a id="11033" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11035" href="Ledger.Utxo.html#4024" class="Datatype">inInterval</a> <a id="11046" href="Ledger.Utxo.html#5899" class="Function">slot</a> <a id="11051" href="Ledger.Transaction.html#3858" class="Function">txvldt</a>
      <a id="11064" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11066" href="Ledger.Utxo.html#2517" class="Function">minfee</a> <a id="11073" href="Ledger.Utxo.html#10916" class="Function">pp</a> <a id="11076" href="Ledger.Utxo.html#10812" class="Bound">tx</a> <a id="11079" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="11081" href="Ledger.Transaction.html#3793" class="Function">txfee</a>
      <a id="11093" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11095" href="Ledger.Utxo.html#8927" class="Function">consumed</a> <a id="11104" href="Ledger.Utxo.html#10916" class="Function">pp</a> <a id="11107" href="Ledger.Utxo.html#10810" class="Bound">s</a> <a id="11109" href="Ledger.Utxo.html#10854" class="Field">txb</a> <a id="11113" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11115" href="Ledger.Utxo.html#9096" class="Function">produced</a> <a id="11124" href="Ledger.Utxo.html#10916" class="Function">pp</a> <a id="11127" href="Ledger.Utxo.html#10810" class="Bound">s</a> <a id="11129" href="Ledger.Utxo.html#10854" class="Field">txb</a>
      <a id="11139" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11141" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="11146" href="Ledger.Transaction.html#3825" class="Function">mint</a> <a id="11151" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11153" class="Number">0</a>
      <a id="11161" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11163" href="Ledger.Transaction.html#4216" class="Function">txsize</a> <a id="11170" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="11172" href="Ledger.PParams.html#1323" class="Field">maxTxSize</a> <a id="11182" href="Ledger.Utxo.html#10916" class="Function">pp</a>
      <a id="11191" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11193" href="Axiom.Set.html#9420" class="Function">All</a> <a id="11197" class="Symbol">(λ</a> <a id="11200" href="Ledger.Utxo.html#11200" class="Bound">txout</a> <a id="11206" class="Symbol">→</a>  <a id="11209" href="Ledger.TokenAlgebra.html#974" class="Function">inject</a> <a id="11216" class="Symbol">(</a><a id="11217" href="Ledger.Utxo.html#1328" class="Function">utxoEntrySize</a> <a id="11231" class="Symbol">(</a><a id="11232" href="Ledger.Utxo.html#11200" class="Bound">txout</a> <a id="11238" class="Symbol">.</a><a id="11239" href="Data.Product.Base.html#622" class="Field">proj₂</a><a id="11244" class="Symbol">)</a> <a id="11246" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11248" href="Ledger.PParams.html#1631" class="Field">minUTxOValue</a> <a id="11261" href="Ledger.Utxo.html#10916" class="Function">pp</a><a id="11263" class="Symbol">)</a>
                    <a id="11285" href="Ledger.TokenAlgebra.html#1140" class="Function Operator">≤ᵗ</a> <a id="11288" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="11297" class="Symbol">(</a><a id="11298" href="Ledger.Utxo.html#11200" class="Bound">txout</a> <a id="11304" class="Symbol">.</a><a id="11305" href="Data.Product.Base.html#622" class="Field">proj₂</a><a id="11310" class="Symbol">))</a>
            <a id="11325" class="Symbol">(</a><a id="11326" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="11333" class="Symbol">.</a><a id="11334" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="11339" class="Symbol">)</a>
      <a id="11347" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11349" href="Axiom.Set.html#9420" class="Function">All</a> <a id="11353" class="Symbol">(λ</a> <a id="11356" href="Ledger.Utxo.html#11356" class="Bound">txout</a> <a id="11362" class="Symbol">→</a> <a id="11364" href="Ledger.Abstract.html#521" class="Field">serSize</a> <a id="11372" class="Symbol">(</a><a id="11373" href="Ledger.Transaction.html#5015" class="Function">getValue</a> <a id="11382" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="11384" href="Ledger.Utxo.html#11356" class="Bound">txout</a> <a id="11390" class="Symbol">.</a><a id="11391" href="Data.Product.Base.html#622" class="Field">proj₂</a><a id="11396" class="Symbol">)</a> <a id="11398" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="11400" href="Ledger.PParams.html#1385" class="Field">maxValSize</a> <a id="11411" href="Ledger.Utxo.html#10916" class="Function">pp</a><a id="11413" class="Symbol">)</a>
            <a id="11427" class="Symbol">(</a><a id="11428" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="11435" class="Symbol">.</a><a id="11436" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="11441" class="Symbol">)</a>
      <a id="11449" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11451" href="Axiom.Set.html#9420" class="Function">All</a> <a id="11455" class="Symbol">(</a><a id="11456" href="Data.Sum.Relation.Unary.All.html#617" class="Datatype">Sum.All</a> <a id="11464" class="Symbol">(</a><a id="11465" href="Function.Base.html#716" class="Function">const</a> <a id="11471" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a><a id="11472" class="Symbol">)</a> <a id="11474" class="Symbol">(λ</a> <a id="11477" href="Ledger.Utxo.html#11477" class="Bound">a</a> <a id="11479" class="Symbol">→</a> <a id="11481" href="Ledger.Utxo.html#11477" class="Bound">a</a> <a id="11483" class="Symbol">.</a><a id="11484" href="Ledger.Address.html#1193" class="Field">BootstrapAddr.attrsSize</a> <a id="11508" href="Interface.HasOrder.html#293" class="Field Operator">≤</a> <a id="11510" class="Number">64</a><a id="11512" class="Symbol">)</a> <a id="11514" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="11516" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="11521" class="Symbol">)</a>
            <a id="11535" class="Symbol">(</a><a id="11536" href="Interface.IsSet.html#837" class="Function">range</a> <a id="11542" class="Symbol">(</a><a id="11543" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="11550" href="Axiom.Set.Map.html#2338" class="Function Operator">ˢ</a><a id="11551" class="Symbol">))</a>
      <a id="11560" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11562" href="Axiom.Set.html#9420" class="Function">All</a> <a id="11566" class="Symbol">(λ</a> <a id="11569" href="Ledger.Utxo.html#11569" class="Bound">a</a> <a id="11571" class="Symbol">→</a> <a id="11573" href="Ledger.Address.html#1992" class="Function">netId</a> <a id="11579" class="Symbol">(</a><a id="11580" href="Ledger.Utxo.html#11569" class="Bound">a</a> <a id="11582" class="Symbol">.</a><a id="11583" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="11588" class="Symbol">)</a> <a id="11590" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11592" href="Ledger.Transaction.html#2707" class="Field">networkId</a><a id="11601" class="Symbol">)</a> <a id="11603" class="Symbol">(</a><a id="11604" href="Interface.IsSet.html#837" class="Function">range</a> <a id="11610" class="Symbol">(</a><a id="11611" href="Ledger.Transaction.html#3755" class="Function">txouts</a> <a id="11618" href="Axiom.Set.Map.html#2338" class="Function Operator">ˢ</a><a id="11619" class="Symbol">))</a>
      <a id="11628" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="11630" href="Axiom.Set.html#9420" class="Function">All</a> <a id="11634" class="Symbol">(λ</a> <a id="11637" href="Ledger.Utxo.html#11637" class="Bound">a</a> <a id="11639" class="Symbol">→</a> <a id="11641" href="Ledger.Utxo.html#11637" class="Bound">a</a> <a id="11643" class="Symbol">.</a><a id="11644" href="Ledger.Address.html#1244" class="Field">RwdAddr.net</a>   <a id="11658" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11660" href="Ledger.Transaction.html#2707" class="Field">networkId</a><a id="11669" class="Symbol">)</a> <a id="11671" class="Symbol">(</a><a id="11672" href="Interface.IsSet.html#794" class="Function">dom</a>  <a id="11677" class="Symbol">(</a><a id="11678" href="Ledger.Transaction.html#3947" class="Function">txwdrls</a> <a id="11686" href="Axiom.Set.Map.html#2338" class="Function Operator">ˢ</a><a id="11687" class="Symbol">))</a>

    <a id="11695" href="Ledger.Utxo.html#11695" class="Function">UTXO-premises?</a> <a id="11710" class="Symbol">:</a> <a id="11712" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="11716" href="Ledger.Utxo.html#10946" class="Function">UTXO-premises</a>
    <a id="11734" href="Ledger.Utxo.html#11695" class="Function">UTXO-premises?</a> <a id="11749" class="Symbol">=</a> <a id="11751" href="Interface.Decidable.Instance.html#1079" class="Function Operator">¿</a> <a id="11753" href="Ledger.Utxo.html#10946" class="Function">UTXO-premises</a> <a id="11767" href="Interface.Decidable.Instance.html#1079" class="Function Operator">¿</a>

    <a id="11774" href="Ledger.Utxo.html#11774" class="Function">computeProof</a> <a id="11787" class="Symbol">=</a>
      <a id="11795" href="Function.Base.html#4053" class="Function Operator">case</a> <a id="11800" href="Ledger.Utxo.html#11695" class="Function">UTXO-premises?</a> <a id="11815" href="Function.Base.html#4053" class="Function Operator">of</a> <a id="11818" class="Symbol">λ</a> <a id="11820" class="Keyword">where</a>
        <a id="11834" class="Symbol">(</a><a id="11835" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="11839" class="Symbol">(</a><a id="11840" href="Ledger.Utxo.html#11840" class="Bound">p₀</a> <a id="11843" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11845" href="Ledger.Utxo.html#11845" class="Bound">p₁</a> <a id="11848" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11850" href="Ledger.Utxo.html#11850" class="Bound">p₂</a> <a id="11853" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11855" href="Ledger.Utxo.html#11855" class="Bound">p₃</a> <a id="11858" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11860" href="Ledger.Utxo.html#11860" class="Bound">p₄</a> <a id="11863" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11865" href="Ledger.Utxo.html#11865" class="Bound">p₅</a> <a id="11868" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11870" href="Ledger.Utxo.html#11870" class="Bound">p₆</a> <a id="11873" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11875" href="Ledger.Utxo.html#11875" class="Bound">p₇</a> <a id="11878" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11880" href="Ledger.Utxo.html#11880" class="Bound">p₈</a> <a id="11883" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11885" href="Ledger.Utxo.html#11885" class="Bound">p₉</a> <a id="11888" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11890" href="Ledger.Utxo.html#11890" class="Bound">p₁₀</a> <a id="11894" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11896" href="Ledger.Utxo.html#11896" class="Bound">p₁₁</a><a id="11899" class="Symbol">))</a> <a id="11902" class="Symbol">→</a>
          <a id="11914" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="11919" class="Symbol">(_</a> <a id="11922" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="11924" href="Ledger.Utxo.html#9554" class="InductiveConstructor">UTXO-inductive</a> <a id="11939" href="Ledger.Utxo.html#11840" class="Bound">p₀</a> <a id="11942" href="Ledger.Utxo.html#11845" class="Bound">p₁</a> <a id="11945" href="Ledger.Utxo.html#11850" class="Bound">p₂</a> <a id="11948" href="Ledger.Utxo.html#11855" class="Bound">p₃</a> <a id="11951" href="Ledger.Utxo.html#11860" class="Bound">p₄</a> <a id="11954" href="Ledger.Utxo.html#11865" class="Bound">p₅</a> <a id="11957" href="Ledger.Utxo.html#11870" class="Bound">p₆</a> <a id="11960" href="Ledger.Utxo.html#11875" class="Bound">p₇</a> <a id="11963" href="Ledger.Utxo.html#11880" class="Bound">p₈</a> <a id="11966" href="Ledger.Utxo.html#11885" class="Bound">p₉</a> <a id="11969" href="Ledger.Utxo.html#11890" class="Bound">p₁₀</a> <a id="11973" href="Ledger.Utxo.html#11896" class="Bound">p₁₁</a><a id="11976" class="Symbol">)</a>
        <a id="11986" class="Symbol">(</a><a id="11987" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="11990" class="Symbol">_)</a> <a id="11993" class="Symbol">→</a> <a id="11995" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

    <a id="12008" href="Ledger.Utxo.html#12008" class="Function">completeness</a> <a id="12021" class="Symbol">:</a> <a id="12023" class="Symbol">∀</a> <a id="12025" href="Ledger.Utxo.html#12025" class="Bound">s&#39;</a> <a id="12028" class="Symbol">→</a> <a id="12030" href="Ledger.Utxo.html#10808" class="Bound">Γ</a> <a id="12032" href="Ledger.Utxo.html#7401" class="Datatype Operator">⊢</a> <a id="12034" href="Ledger.Utxo.html#10810" class="Bound">s</a> <a id="12036" href="Ledger.Utxo.html#7401" class="Datatype Operator">⇀⦇</a> <a id="12039" href="Ledger.Utxo.html#10812" class="Bound">tx</a> <a id="12042" href="Ledger.Utxo.html#7401" class="Datatype Operator">,UTXO⦈</a> <a id="12049" href="Ledger.Utxo.html#12025" class="Bound">s&#39;</a> <a id="12052" class="Symbol">→</a> <a id="12054" class="Symbol">_</a>
    <a id="12060" href="Ledger.Utxo.html#12008" class="Function">completeness</a> <a id="12073" href="Ledger.Utxo.html#12073" class="Bound">s&#39;</a> <a id="12076" href="Ledger.Utxo.html#12076" class="Bound">h</a><a id="12077" class="Symbol">@(</a><a id="12079" href="Ledger.Utxo.html#9554" class="InductiveConstructor">UTXO-inductive</a> <a id="12094" href="Ledger.Utxo.html#12094" class="Bound">q₀</a> <a id="12097" href="Ledger.Utxo.html#12097" class="Bound">q₁</a> <a id="12100" href="Ledger.Utxo.html#12100" class="Bound">q₂</a> <a id="12103" href="Ledger.Utxo.html#12103" class="Bound">q₃</a> <a id="12106" href="Ledger.Utxo.html#12106" class="Bound">q₄</a> <a id="12109" href="Ledger.Utxo.html#12109" class="Bound">q₅</a> <a id="12112" href="Ledger.Utxo.html#12112" class="Bound">q₆</a> <a id="12115" href="Ledger.Utxo.html#12115" class="Bound">q₇</a> <a id="12118" href="Ledger.Utxo.html#12118" class="Bound">q₈</a> <a id="12121" href="Ledger.Utxo.html#12121" class="Bound">q₉</a> <a id="12124" href="Ledger.Utxo.html#12124" class="Bound">q₁₀</a> <a id="12128" href="Ledger.Utxo.html#12128" class="Bound">q₁₁</a><a id="12131" class="Symbol">)</a> <a id="12133" class="Symbol">=</a> <a id="12135" href="Ledger.Utxo.html#12157" class="Function">QED</a>
      <a id="12145" class="Keyword">where</a>
      <a id="12157" href="Ledger.Utxo.html#12157" class="Function">QED</a> <a id="12161" class="Symbol">:</a> <a id="12163" href="Interface.Functor.html#448" class="Function">map</a> <a id="12167" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="12173" href="Ledger.Utxo.html#11774" class="Function">computeProof</a> <a id="12186" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="12188" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="12193" href="Ledger.Utxo.html#12073" class="Bound">s&#39;</a>
      <a id="12202" href="Ledger.Utxo.html#12157" class="Function">QED</a> <a id="12206" class="Keyword">with</a> <a id="12211" href="Ledger.Utxo.html#11695" class="Function">UTXO-premises?</a>
      <a id="12232" href="Ledger.Utxo.html#12157" class="Function">...</a> <a id="12236" class="Symbol">|</a> <a id="12238" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="12242" class="Symbol">_</a> <a id="12244" class="Symbol">=</a> <a id="12246" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
      <a id="12257" href="Ledger.Utxo.html#12157" class="Function">...</a> <a id="12261" class="Symbol">|</a> <a id="12263" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="12266" href="Ledger.Utxo.html#12266" class="Bound">q</a> <a id="12268" class="Symbol">=</a> <a id="12270" href="Data.Empty.html#1041" class="Function">⊥-elim</a>
                 <a id="12294" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="12296" href="Ledger.Utxo.html#12266" class="Bound">q</a> <a id="12298" class="Symbol">(</a><a id="12299" href="Ledger.Utxo.html#12094" class="Bound">q₀</a> <a id="12302" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12304" href="Ledger.Utxo.html#12097" class="Bound">q₁</a> <a id="12307" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12309" href="Ledger.Utxo.html#12100" class="Bound">q₂</a> <a id="12312" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12314" href="Ledger.Utxo.html#12103" class="Bound">q₃</a> <a id="12317" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12319" href="Ledger.Utxo.html#12106" class="Bound">q₄</a> <a id="12322" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12324" href="Ledger.Utxo.html#12109" class="Bound">q₅</a> <a id="12327" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12329" href="Ledger.Utxo.html#12112" class="Bound">q₆</a> <a id="12332" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12334" href="Ledger.Utxo.html#12115" class="Bound">q₇</a> <a id="12337" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12339" href="Ledger.Utxo.html#12118" class="Bound">q₈</a> <a id="12342" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12344" href="Ledger.Utxo.html#12121" class="Bound">q₉</a> <a id="12347" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12349" href="Ledger.Utxo.html#12124" class="Bound">q₁₀</a> <a id="12353" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12355" href="Ledger.Utxo.html#12128" class="Bound">q₁₁</a><a id="12358" class="Symbol">)</a>
<a id="12360" class="Markup">\end{code}</a><a id="12370" class="Background">
\caption{UTXO inference rules}
\label{fig:rules:utxo-shelley}
\end{figure*}
</a></pre></body></html>