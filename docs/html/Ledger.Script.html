<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Script</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Scripts}
</a><a id="19" class="Markup">\begin{code}[hide]</a>
<a id="38" class="Symbol">{-#</a> <a id="42" class="Keyword">OPTIONS</a> <a id="50" class="Pragma">--safe</a> <a id="57" class="Symbol">#-}</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Algebra.html" class="Module">Algebra</a> <a id="82" class="Keyword">using</a> <a id="88" class="Symbol">(</a><a id="89" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a><a id="106" class="Symbol">)</a>
<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Algebra.Morphism.html" class="Module">Algebra.Morphism</a>
<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.List.Relation.Binary.Sublist.Propositional.html" class="Module">Data.List.Relation.Binary.Sublist.Propositional</a> <a id="279" class="Symbol">as</a> <a id="282" class="Module">S</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="316" class="Keyword">using</a> <a id="322" class="Symbol">(</a><a id="323" href="Data.Nat.Properties.html#16466" class="Function">+-0-commutativeMonoid</a><a id="344" class="Symbol">)</a>

<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a>

<a id="380" class="Keyword">open</a> <a id="385" class="Keyword">import</a> <a id="392" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="407" class="Keyword">hiding</a> <a id="414" class="Symbol">(</a><a id="415" href="Axiom.Set.html#9420" class="Function">All</a><a id="418" class="Symbol">;</a> <a id="420" href="Axiom.Set.html#9489" class="Function">Any</a><a id="423" class="Symbol">)</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a>

<a id="477" class="Keyword">module</a> <a id="484" href="Ledger.Script.html" class="Module">Ledger.Script</a>
  <a id="500" class="Symbol">(</a><a id="501" href="Ledger.Script.html#501" class="Bound">crypto</a> <a id="508" class="Symbol">:</a> <a id="510" class="Symbol">_)</a> <a id="513" class="Symbol">(</a><a id="514" class="Keyword">open</a> <a id="519" href="Ledger.Crypto.html#1473" class="Module">Crypto</a> <a id="526" href="Ledger.Script.html#501" class="Bound">crypto</a><a id="532" class="Symbol">)</a>
  <a id="536" class="Symbol">(</a><a id="537" href="Ledger.Script.html#537" class="Bound">es</a>     <a id="544" class="Symbol">:</a> <a id="546" class="Symbol">_)</a> <a id="549" class="Symbol">(</a><a id="550" class="Keyword">open</a> <a id="555" href="Ledger.Epoch.html#228" class="Module">EpochStructure</a> <a id="570" href="Ledger.Script.html#537" class="Bound">es</a><a id="572" class="Symbol">)</a>
  <a id="576" class="Keyword">where</a>

<a id="583" class="Keyword">record</a> <a id="P1ScriptStructure"></a><a id="590" href="Ledger.Script.html#590" class="Record">P1ScriptStructure</a> <a id="608" class="Symbol">:</a> <a id="610" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="615" class="Keyword">where</a>
  <a id="623" class="Keyword">field</a> <a id="P1ScriptStructure.P1Script"></a><a id="629" href="Ledger.Script.html#629" class="Field">P1Script</a> <a id="638" class="Symbol">:</a> <a id="640" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="P1ScriptStructure.validP1Script"></a><a id="652" href="Ledger.Script.html#652" class="Field">validP1Script</a> <a id="666" class="Symbol">:</a> <a id="668" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="670" href="Ledger.Crypto.html#1698" class="Function">KeyHash</a> <a id="678" class="Symbol">→</a> <a id="680" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="686" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="691" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="693" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="699" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="704" class="Symbol">→</a> <a id="706" href="Ledger.Script.html#629" class="Field">P1Script</a> <a id="715" class="Symbol">→</a> <a id="717" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="P1ScriptStructure.validP1Script?"></a><a id="729" href="Ledger.Script.html#729" class="Field">validP1Script?</a> <a id="744" class="Symbol">:</a> <a id="746" class="Symbol">∀</a> <a id="748" href="Ledger.Script.html#748" class="Bound">khs</a> <a id="752" href="Ledger.Script.html#752" class="Bound">I</a> <a id="754" href="Ledger.Script.html#754" class="Bound">s</a> <a id="756" class="Symbol">→</a> <a id="758" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="762" class="Symbol">(</a><a id="763" href="Ledger.Script.html#652" class="Field">validP1Script</a> <a id="777" href="Ledger.Script.html#748" class="Bound">khs</a> <a id="781" href="Ledger.Script.html#752" class="Bound">I</a> <a id="783" href="Ledger.Script.html#754" class="Bound">s</a><a id="784" class="Symbol">)</a>
        <a id="794" class="Symbol">⦃</a> <a id="P1ScriptStructure.Hashable-P1Script"></a><a id="796" href="Ledger.Script.html#796" class="Field">Hashable-P1Script</a> <a id="814" class="Symbol">⦄</a> <a id="816" class="Symbol">:</a> <a id="818" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="827" href="Ledger.Script.html#629" class="Field">P1Script</a> <a id="836" href="Ledger.Crypto.html#1595" class="Field">ScriptHash</a>
        <a id="855" class="Symbol">⦃</a> <a id="P1ScriptStructure.DecEq-P1Script"></a><a id="857" href="Ledger.Script.html#857" class="Field">DecEq-P1Script</a>    <a id="875" class="Symbol">⦄</a> <a id="877" class="Symbol">:</a> <a id="879" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="885" href="Ledger.Script.html#629" class="Field">P1Script</a>
  <a id="896" class="Keyword">instance</a>
    <a id="P1ScriptStructure.Dec-ValidP1Script"></a><a id="909" href="Ledger.Script.html#909" class="Function">Dec-ValidP1Script</a> <a id="927" class="Symbol">:</a> <a id="929" class="Symbol">∀</a> <a id="931" class="Symbol">{</a><a id="932" href="Ledger.Script.html#932" class="Bound">khs</a> <a id="936" href="Ledger.Script.html#936" class="Bound">I</a> <a id="938" href="Ledger.Script.html#938" class="Bound">s</a><a id="939" class="Symbol">}</a> <a id="941" class="Symbol">→</a> <a id="943" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="947" class="Symbol">(</a><a id="948" href="Ledger.Script.html#652" class="Field">validP1Script</a> <a id="962" href="Ledger.Script.html#932" class="Bound">khs</a> <a id="966" href="Ledger.Script.html#936" class="Bound">I</a> <a id="968" href="Ledger.Script.html#938" class="Bound">s</a><a id="969" class="Symbol">)</a>
    <a id="975" href="Ledger.Script.html#909" class="Function">Dec-ValidP1Script</a> <a id="993" class="Symbol">=</a> <a id="995" href="Ledger.Script.html#729" class="Field">validP1Script?</a> <a id="1010" class="Symbol">_</a> <a id="1012" class="Symbol">_</a> <a id="1014" class="Symbol">_</a>

<a id="1017" class="Keyword">record</a> <a id="PlutusStructure"></a><a id="1024" href="Ledger.Script.html#1024" class="Record">PlutusStructure</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="1047" class="Keyword">where</a>
  <a id="1055" class="Keyword">field</a> <a id="PlutusStructure.Dataʰ"></a><a id="1061" href="Ledger.Script.html#1061" class="Field">Dataʰ</a> <a id="1067" class="Symbol">:</a> <a id="1069" href="Ledger.Crypto.html#389" class="Record">HashableSet</a>
        <a id="PlutusStructure.Language"></a><a id="1089" href="Ledger.Script.html#1089" class="Field">Language</a> <a id="PlutusStructure.PlutusScript"></a><a id="1098" href="Ledger.Script.html#1098" class="Field">PlutusScript</a> <a id="PlutusStructure.CostModel"></a><a id="1111" href="Ledger.Script.html#1111" class="Field">CostModel</a> <a id="PlutusStructure.Prices"></a><a id="1121" href="Ledger.Script.html#1121" class="Field">Prices</a> <a id="PlutusStructure.LangDepView"></a><a id="1128" href="Ledger.Script.html#1128" class="Field">LangDepView</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PlutusStructure.ExUnit-CommutativeMonoid"></a><a id="1154" href="Ledger.Script.html#1154" class="Field">ExUnit-CommutativeMonoid</a>  <a id="1180" class="Symbol">:</a> <a id="1182" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a> <a id="1200" href="Level.html#512" class="Function">0ℓ</a> <a id="1203" href="Level.html#512" class="Function">0ℓ</a>
        <a id="1214" class="Symbol">⦃</a> <a id="PlutusStructure.Hashable-PlutusScript"></a><a id="1216" href="Ledger.Script.html#1216" class="Field">Hashable-PlutusScript</a> <a id="1238" class="Symbol">⦄</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="1251" href="Ledger.Script.html#1098" class="Field">PlutusScript</a> <a id="1264" href="Ledger.Crypto.html#1595" class="Field">ScriptHash</a>
        <a id="1283" class="Symbol">⦃</a> <a id="PlutusStructure.DecEq-PlutusScript"></a><a id="1285" href="Ledger.Script.html#1285" class="Field">DecEq-PlutusScript</a>    <a id="1307" class="Symbol">⦄</a> <a id="1309" class="Symbol">:</a> <a id="1311" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1317" href="Ledger.Script.html#1098" class="Field">PlutusScript</a>
        <a id="1338" class="Symbol">⦃</a> <a id="PlutusStructure.DecEq-CostModel"></a><a id="1340" href="Ledger.Script.html#1340" class="Field">DecEq-CostModel</a>       <a id="1362" class="Symbol">⦄</a> <a id="1364" class="Symbol">:</a> <a id="1366" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1372" href="Ledger.Script.html#1111" class="Field">CostModel</a>
        <a id="1390" class="Symbol">⦃</a> <a id="PlutusStructure.DecEq-LangDepView"></a><a id="1392" href="Ledger.Script.html#1392" class="Field">DecEq-LangDepView</a>     <a id="1414" class="Symbol">⦄</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1424" href="Ledger.Script.html#1128" class="Field">LangDepView</a>

  <a id="1439" class="Keyword">open</a> <a id="1444" href="Algebra.Bundles.html#6578" class="Module">CommutativeMonoid</a> <a id="1462" href="Ledger.Script.html#1154" class="Field">ExUnit-CommutativeMonoid</a> <a id="1487" class="Keyword">public</a>
    <a id="1498" class="Keyword">using</a> <a id="1504" class="Symbol">()</a>
    <a id="1511" class="Keyword">renaming</a> <a id="1520" class="Symbol">(</a><a id="1521" href="Algebra.Bundles.html#6700" class="Field Operator">_≈_</a> <a id="1525" class="Symbol">to</a> <a id="1528" class="Field Operator">_≈ᵉ_</a><a id="1532" class="Symbol">;</a> <a id="1534" href="Algebra.Bundles.html#6778" class="Field">ε</a> <a id="1536" class="Symbol">to</a> <a id="1539" class="Field">εᵉ</a><a id="1541" class="Symbol">;</a> <a id="1543" href="Algebra.Bundles.html#6668" class="Field">Carrier</a> <a id="1551" class="Symbol">to</a> <a id="1554" class="Field">ExUnits</a><a id="1561" class="Symbol">;</a> <a id="1563" href="Relation.Binary.Structures.html#1582" class="Function">refl</a> <a id="1568" class="Symbol">to</a> <a id="1571" class="Function">reflᵉ</a><a id="1576" class="Symbol">;</a> <a id="1578" href="Algebra.Bundles.html#6740" class="Field Operator">_∙_</a> <a id="1582" class="Symbol">to</a> <a id="1585" class="Field Operator">_+ᵉˣ_</a><a id="1590" class="Symbol">)</a>


  <a id="1596" class="Keyword">field</a>  <a id="PlutusStructure._≥ᵉ_"></a><a id="1603" href="Ledger.Script.html#1603" class="Field Operator">_≥ᵉ_</a>              <a id="1621" class="Symbol">:</a> <a id="1623" href="Ledger.Script.html#1554" class="Function">ExUnits</a> <a id="1631" class="Symbol">→</a> <a id="1633" href="Ledger.Script.html#1554" class="Function">ExUnits</a> <a id="1641" class="Symbol">→</a> <a id="1643" href="Agda.Primitive.html#320" class="Primitive">Set</a>
         <a id="1656" class="Symbol">⦃</a> <a id="PlutusStructure.DecEq-ExUnits"></a><a id="1658" href="Ledger.Script.html#1658" class="Field">DecEq-ExUnits</a> <a id="1672" class="Symbol">⦄</a> <a id="1674" class="Symbol">:</a> <a id="1676" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1682" href="Ledger.Script.html#1554" class="Function">ExUnits</a>
         <a id="1699" class="Symbol">⦃</a> <a id="PlutusStructure.DecEQ-Prices"></a><a id="1701" href="Ledger.Script.html#1701" class="Field">DecEQ-Prices</a>  <a id="1715" class="Symbol">⦄</a> <a id="1717" class="Symbol">:</a> <a id="1719" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1725" href="Ledger.Script.html#1121" class="Field">Prices</a>
         <a id="1741" class="Comment">-- GetPair              : ExUnits → Set × Set</a>
         <a id="1796" class="Comment">-- coinIsMonoidMorphism : GetPair Is ExUnit-CommutativeMonoid</a>
         <a id="1867" class="Comment">--                          -CommutativeMonoid⟶ +-0-commutativeMonoid</a>

  <a id="1940" class="Keyword">open</a> <a id="1945" href="Ledger.Crypto.html#389" class="Module">HashableSet</a> <a id="1957" href="Ledger.Script.html#1061" class="Field">Dataʰ</a> <a id="1963" class="Keyword">renaming</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Ledger.Crypto.html#450" class="Field">T</a> <a id="1975" class="Symbol">to</a> <a id="1978" class="Field">Data</a><a id="1982" class="Symbol">;</a> <a id="1984" href="Ledger.Crypto.html#227" class="Function">THash</a> <a id="1990" class="Symbol">to</a> <a id="1993" class="Function">DataHash</a><a id="2001" class="Symbol">)</a> <a id="2003" class="Keyword">public</a>

  <a id="2013" class="Comment">-- Type aliases for Data</a>
  <a id="PlutusStructure.Datum"></a><a id="2040" href="Ledger.Script.html#2040" class="Function">Datum</a>    <a id="2049" class="Symbol">=</a> <a id="2051" href="Ledger.Script.html#1978" class="Function">Data</a>
  <a id="PlutusStructure.Redeemer"></a><a id="2058" href="Ledger.Script.html#2058" class="Function">Redeemer</a> <a id="2067" class="Symbol">=</a> <a id="2069" href="Ledger.Script.html#1978" class="Function">Data</a>

  <a id="2077" class="Keyword">field</a> <a id="PlutusStructure.validPlutusScript"></a><a id="2083" href="Ledger.Script.html#2083" class="Field">validPlutusScript</a> <a id="2101" class="Symbol">:</a> <a id="2103" href="Ledger.Script.html#1111" class="Field">CostModel</a> <a id="2113" class="Symbol">→</a> <a id="2115" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2120" href="Ledger.Script.html#1978" class="Function">Data</a> <a id="2125" class="Symbol">→</a> <a id="2127" href="Ledger.Script.html#1554" class="Function">ExUnits</a> <a id="2135" class="Symbol">→</a> <a id="2137" href="Ledger.Script.html#1098" class="Field">PlutusScript</a> <a id="2150" class="Symbol">→</a> <a id="2152" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PlutusStructure.validPlutusScript?"></a><a id="2164" href="Ledger.Script.html#2164" class="Field">validPlutusScript?</a> <a id="2183" class="Symbol">:</a> <a id="2185" class="Symbol">∀</a> <a id="2187" href="Ledger.Script.html#2187" class="Bound">cm</a> <a id="2190" href="Ledger.Script.html#2190" class="Bound">ds</a> <a id="2193" href="Ledger.Script.html#2193" class="Bound">eu</a> <a id="2196" href="Ledger.Script.html#2196" class="Bound">s</a> <a id="2198" class="Symbol">→</a> <a id="2200" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="2204" class="Symbol">(</a><a id="2205" href="Ledger.Script.html#2083" class="Field">validPlutusScript</a> <a id="2223" href="Ledger.Script.html#2187" class="Bound">cm</a> <a id="2226" href="Ledger.Script.html#2190" class="Bound">ds</a> <a id="2229" href="Ledger.Script.html#2193" class="Bound">eu</a> <a id="2232" href="Ledger.Script.html#2196" class="Bound">s</a><a id="2233" class="Symbol">)</a>
        <a id="PlutusStructure.language"></a><a id="2243" href="Ledger.Script.html#2243" class="Field">language</a> <a id="2252" class="Symbol">:</a> <a id="2254" href="Ledger.Script.html#1098" class="Field">PlutusScript</a> <a id="2267" class="Symbol">→</a> <a id="2269" href="Ledger.Script.html#1089" class="Field">Language</a>
        <a id="PlutusStructure.toData"></a><a id="2286" href="Ledger.Script.html#2286" class="Field">toData</a> <a id="2293" class="Symbol">:</a> <a id="2295" class="Symbol">∀</a> <a id="2297" class="Symbol">{</a><a id="2298" href="Ledger.Script.html#2298" class="Bound">A</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="2305" class="Symbol">}</a> <a id="2307" class="Symbol">→</a> <a id="2309" href="Ledger.Script.html#2298" class="Bound">A</a> <a id="2311" class="Symbol">→</a> <a id="2313" href="Ledger.Script.html#1978" class="Function">Data</a>

<a id="2319" class="Keyword">record</a> <a id="ScriptStructure"></a><a id="2326" href="Ledger.Script.html#2326" class="Record">ScriptStructure</a> <a id="2342" class="Symbol">:</a> <a id="2344" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="2349" class="Keyword">where</a>
  <a id="2357" class="Keyword">field</a> <a id="ScriptStructure.p1s"></a><a id="2363" href="Ledger.Script.html#2363" class="Field">p1s</a> <a id="2367" class="Symbol">:</a> <a id="2369" href="Ledger.Script.html#590" class="Record">P1ScriptStructure</a>
        <a id="ScriptStructure.ps"></a><a id="2395" href="Ledger.Script.html#2395" class="Field">ps</a>  <a id="2399" class="Symbol">:</a> <a id="2401" href="Ledger.Script.html#1024" class="Record">PlutusStructure</a>

  <a id="2420" class="Comment">-- it is not possible to define this function</a>
  <a id="2468" class="Keyword">field</a> <a id="ScriptStructure.hashRespectsUnion"></a><a id="2474" href="Ledger.Script.html#2474" class="Field">hashRespectsUnion</a> <a id="2492" class="Symbol">:</a> <a id="2494" class="Symbol">{</a><a id="2495" href="Ledger.Script.html#2495" class="Bound">A</a> <a id="2497" href="Ledger.Script.html#2497" class="Bound">B</a> <a id="2499" href="Ledger.Script.html#2499" class="Bound">Hash</a> <a id="2504" class="Symbol">:</a> <a id="2506" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="2509" class="Symbol">}</a> <a id="2511" class="Symbol">→</a> <a id="2513" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="2522" href="Ledger.Script.html#2495" class="Bound">A</a> <a id="2524" href="Ledger.Script.html#2499" class="Bound">Hash</a> <a id="2529" class="Symbol">→</a> <a id="2531" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="2540" href="Ledger.Script.html#2497" class="Bound">B</a> <a id="2542" href="Ledger.Script.html#2499" class="Bound">Hash</a> <a id="2547" class="Symbol">→</a> <a id="2549" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="2558" class="Symbol">(</a><a id="2559" href="Ledger.Script.html#2495" class="Bound">A</a> <a id="2561" href="Data.Sum.Base.html#616" class="Datatype Operator">⊎</a> <a id="2563" href="Ledger.Script.html#2497" class="Bound">B</a><a id="2564" class="Symbol">)</a> <a id="2566" href="Ledger.Script.html#2499" class="Bound">Hash</a>

  <a id="2574" class="Keyword">open</a> <a id="2579" href="Ledger.Script.html#590" class="Module">P1ScriptStructure</a> <a id="2597" href="Ledger.Script.html#2363" class="Field">p1s</a> <a id="2601" class="Keyword">public</a>
  <a id="2610" class="Keyword">open</a> <a id="2615" href="Ledger.Script.html#1024" class="Module">PlutusStructure</a> <a id="2631" href="Ledger.Script.html#2395" class="Field">ps</a> <a id="2634" class="Keyword">public</a>
    <a id="2645" class="Keyword">renaming</a> <a id="2654" class="Symbol">(</a> <a id="2656" href="Ledger.Script.html#1098" class="Field">PlutusScript</a>       <a id="2675" class="Symbol">to</a> <a id="2678" class="Field">P2Script</a>
             <a id="2700" class="Symbol">;</a> <a id="2702" href="Ledger.Script.html#2083" class="Field">validPlutusScript</a>  <a id="2721" class="Symbol">to</a> <a id="2724" class="Field">validP2Script</a>
             <a id="2751" class="Symbol">;</a> <a id="2753" href="Ledger.Script.html#2164" class="Field">validPlutusScript?</a> <a id="2772" class="Symbol">to</a> <a id="2775" class="Field">validP2Script?</a>
             <a id="2803" class="Symbol">)</a>

  <a id="ScriptStructure.Script"></a><a id="2808" href="Ledger.Script.html#2808" class="Function">Script</a> <a id="2815" class="Symbol">=</a> <a id="2817" href="Ledger.Script.html#629" class="Function">P1Script</a> <a id="2826" href="Data.Sum.Base.html#616" class="Datatype Operator">⊎</a> <a id="2828" href="Ledger.Script.html#2678" class="Function">P2Script</a>

  <a id="2840" class="Keyword">open</a> <a id="2845" class="Keyword">import</a> <a id="2852" href="Data.Empty.html" class="Module">Data.Empty</a>
  <a id="2865" class="Keyword">open</a> <a id="2870" class="Keyword">import</a> <a id="2877" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
  <a id="2901" class="Keyword">open</a> <a id="2906" class="Keyword">import</a> <a id="2913" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

  <a id="2954" class="Keyword">instance</a>
    <a id="ScriptStructure.Hashable-Script"></a><a id="2967" href="Ledger.Script.html#2967" class="Function">Hashable-Script</a> <a id="2983" class="Symbol">:</a> <a id="2985" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="2994" href="Ledger.Script.html#2808" class="Function">Script</a> <a id="3001" href="Ledger.Crypto.html#1595" class="Field">ScriptHash</a>
    <a id="3016" href="Ledger.Script.html#2967" class="Function">Hashable-Script</a> <a id="3032" class="Symbol">=</a> <a id="3034" href="Ledger.Script.html#2474" class="Field">hashRespectsUnion</a> <a id="3052" href="Ledger.Script.html#796" class="Function">Hashable-P1Script</a> <a id="3070" href="Ledger.Script.html#1216" class="Function">Hashable-PlutusScript</a>
<a id="3092" class="Markup">\end{code}</a><a id="3102" class="Background">
We define Timelock scripts here. They can verify the presence of keys and whether a transaction happens in a certain slot interval. These scripts are executed as part of the regular witnessing.
\begin{figure*}[h]
</a><a id="3316" class="Markup">\begin{code}</a>
<a id="3329" class="Keyword">data</a> <a id="Timelock"></a><a id="3334" href="Ledger.Script.html#3334" class="Datatype">Timelock</a> <a id="3343" class="Symbol">:</a> <a id="3345" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3349" class="Keyword">where</a>
  <a id="Timelock.RequireAllOf"></a><a id="3357" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a>       <a id="3376" class="Symbol">:</a> <a id="3378" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3383" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>      <a id="3397" class="Symbol">→</a> <a id="3399" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
  <a id="Timelock.RequireAnyOf"></a><a id="3410" href="Ledger.Script.html#3410" class="InductiveConstructor">RequireAnyOf</a>       <a id="3429" class="Symbol">:</a> <a id="3431" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3436" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>      <a id="3450" class="Symbol">→</a> <a id="3452" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
  <a id="Timelock.RequireMOf"></a><a id="3463" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a>         <a id="3482" class="Symbol">:</a> <a id="3484" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3486" class="Symbol">→</a> <a id="3488" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3493" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>  <a id="3503" class="Symbol">→</a> <a id="3505" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
  <a id="Timelock.RequireSig"></a><a id="3516" href="Ledger.Script.html#3516" class="InductiveConstructor">RequireSig</a>         <a id="3535" class="Symbol">:</a> <a id="3537" href="Ledger.Crypto.html#1698" class="Function">KeyHash</a>            <a id="3556" class="Symbol">→</a> <a id="3558" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
  <a id="Timelock.RequireTimeStart"></a><a id="3569" href="Ledger.Script.html#3569" class="InductiveConstructor">RequireTimeStart</a>   <a id="3588" class="Symbol">:</a> <a id="3590" href="Ledger.Epoch.html#341" class="Function">Slot</a>               <a id="3609" class="Symbol">→</a> <a id="3611" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
  <a id="Timelock.RequireTimeExpire"></a><a id="3622" href="Ledger.Script.html#3622" class="InductiveConstructor">RequireTimeExpire</a>  <a id="3641" class="Symbol">:</a> <a id="3643" href="Ledger.Epoch.html#341" class="Function">Slot</a>               <a id="3662" class="Symbol">→</a> <a id="3664" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
<a id="3673" class="Markup">\end{code}</a><a id="3683" class="Background">
</a><a id="3684" class="Markup">\begin{code}[hide]</a>
<a id="3703" class="Keyword">module</a> <a id="3710" href="Ledger.Script.html#3710" class="Module">_</a> <a id="3712" class="Symbol">(</a><a id="3713" href="Ledger.Script.html#3713" class="Bound Operator">_≤_</a> <a id="3717" class="Symbol">:</a> <a id="3719" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="3724" class="Symbol">→</a> <a id="3726" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="3731" class="Symbol">→</a> <a id="3733" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="3736" class="Symbol">)</a> <a id="3738" class="Symbol">(</a><a id="3739" href="Ledger.Script.html#3739" class="Bound Operator">_≤ᵇ_</a> <a id="3744" class="Symbol">:</a> <a id="3746" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="3751" class="Symbol">→</a> <a id="3753" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="3758" class="Symbol">→</a> <a id="3760" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="3764" class="Symbol">)</a> <a id="3766" class="Keyword">where</a>
  <a id="3774" class="Keyword">private</a> <a id="3782" class="Keyword">variable</a>
    <a id="3795" href="Ledger.Script.html#3795" class="Generalizable">s</a> <a id="3797" class="Symbol">:</a> <a id="3799" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
    <a id="3812" href="Ledger.Script.html#3812" class="Generalizable">ss</a> <a id="3815" href="Ledger.Script.html#3815" class="Generalizable">ss&#39;</a> <a id="3819" class="Symbol">:</a> <a id="3821" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3826" href="Ledger.Script.html#3334" class="Datatype">Timelock</a>
    <a id="3839" href="Ledger.Script.html#3839" class="Generalizable">k</a> <a id="3841" class="Symbol">:</a> <a id="3843" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
    <a id="3849" href="Ledger.Script.html#3849" class="Generalizable">x</a> <a id="3851" class="Symbol">:</a> <a id="3853" href="Ledger.Crypto.html#1698" class="Function">KeyHash</a>
    <a id="3865" href="Ledger.Script.html#3865" class="Generalizable">a</a> <a id="3867" href="Ledger.Script.html#3867" class="Generalizable">l</a> <a id="3869" href="Ledger.Script.html#3869" class="Generalizable">r</a> <a id="3871" class="Symbol">:</a> <a id="3873" href="Ledger.Epoch.html#341" class="Function">Slot</a>
<a id="3878" class="Markup">\end{code}</a><a id="3888" class="Background">
</a><a id="3889" class="Markup">\begin{code}</a>
  <a id="3904" class="Keyword">module</a> <a id="3911" href="Ledger.Script.html#3911" class="Module">_</a> <a id="3913" class="Symbol">(</a><a id="3914" href="Ledger.Script.html#3914" class="Bound">khs</a> <a id="3918" class="Symbol">:</a> <a id="3920" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="3922" href="Ledger.Crypto.html#1698" class="Function">KeyHash</a><a id="3929" class="Symbol">)</a> <a id="3931" class="Symbol">(</a><a id="3932" href="Ledger.Script.html#3932" class="Bound">I</a> <a id="3934" class="Symbol">:</a> <a id="3936" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3942" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="3947" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3949" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3955" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="3959" class="Symbol">)</a> <a id="3961" class="Keyword">where</a>
    <a id="3971" class="Keyword">data</a> <a id="3976" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="3989" class="Symbol">:</a> <a id="3991" href="Ledger.Script.html#3334" class="Datatype">Timelock</a> <a id="4000" class="Symbol">→</a> <a id="4002" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="4006" class="Keyword">where</a>
      <a id="4018" href="Ledger.Script.html#4018" class="InductiveConstructor">evalAll</a>  <a id="4027" class="Symbol">:</a> <a id="4029" href="Data.List.Relation.Unary.All.html#1439" class="Datatype">All</a> <a id="4033" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4046" href="Ledger.Script.html#3812" class="Generalizable">ss</a>
               <a id="4064" class="Symbol">→</a> <a id="4066" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4079" class="Symbol">(</a><a id="4080" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a> <a id="4093" href="Ledger.Script.html#3812" class="Generalizable">ss</a><a id="4095" class="Symbol">)</a>
      <a id="4103" href="Ledger.Script.html#4103" class="InductiveConstructor">evalAny</a>  <a id="4112" class="Symbol">:</a> <a id="4114" href="Data.List.Relation.Unary.Any.html#1139" class="Datatype">Any</a> <a id="4118" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4131" href="Ledger.Script.html#3812" class="Generalizable">ss</a>
               <a id="4149" class="Symbol">→</a> <a id="4151" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4164" class="Symbol">(</a><a id="4165" href="Ledger.Script.html#3410" class="InductiveConstructor">RequireAnyOf</a> <a id="4178" href="Ledger.Script.html#3812" class="Generalizable">ss</a><a id="4180" class="Symbol">)</a>
      <a id="4188" href="Ledger.Script.html#4188" class="InductiveConstructor">evalMOf</a>  <a id="4197" class="Symbol">:</a> <a id="4199" href="Ledger.Script.html#3815" class="Generalizable">ss&#39;</a> <a id="4203" href="Data.List.Relation.Binary.Sublist.Setoid.html#1349" class="Function Operator">S.⊆</a> <a id="4207" href="Ledger.Script.html#3812" class="Generalizable">ss</a> <a id="4210" class="Symbol">→</a> <a id="4212" href="Data.List.Relation.Unary.All.html#1439" class="Datatype">All</a> <a id="4216" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4229" href="Ledger.Script.html#3815" class="Generalizable">ss&#39;</a>
               <a id="4248" class="Symbol">→</a> <a id="4250" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4263" class="Symbol">(</a><a id="4264" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="4275" class="Symbol">(</a><a id="4276" href="Data.List.Base.html#5058" class="Function">length</a> <a id="4283" href="Ledger.Script.html#3815" class="Generalizable">ss&#39;</a><a id="4286" class="Symbol">)</a> <a id="4288" href="Ledger.Script.html#3812" class="Generalizable">ss</a><a id="4290" class="Symbol">)</a>
      <a id="4298" href="Ledger.Script.html#4298" class="InductiveConstructor">evalSig</a>  <a id="4307" class="Symbol">:</a> <a id="4309" href="Ledger.Script.html#3849" class="Generalizable">x</a> <a id="4311" href="Interface.IsSet.html#493" class="Function Operator">∈</a> <a id="4313" href="Ledger.Script.html#3914" class="Bound">khs</a>
               <a id="4332" class="Symbol">→</a> <a id="4334" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4347" class="Symbol">(</a><a id="4348" href="Ledger.Script.html#3516" class="InductiveConstructor">RequireSig</a> <a id="4359" href="Ledger.Script.html#3849" class="Generalizable">x</a><a id="4360" class="Symbol">)</a>
      <a id="4368" href="Ledger.Script.html#4368" class="InductiveConstructor">evalTSt</a>  <a id="4377" class="Symbol">:</a> <a id="4379" href="Ledger.Script.html#3932" class="Bound">I</a> <a id="4381" class="Symbol">.</a><a id="4382" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="4388" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4390" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4395" href="Ledger.Script.html#3867" class="Generalizable">l</a> <a id="4397" class="Symbol">→</a> <a id="4399" href="Ledger.Script.html#3865" class="Generalizable">a</a> <a id="4401" href="Ledger.Script.html#3713" class="Bound Operator">≤</a> <a id="4403" href="Ledger.Script.html#3867" class="Generalizable">l</a>
               <a id="4420" class="Symbol">→</a> <a id="4422" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4435" class="Symbol">(</a><a id="4436" href="Ledger.Script.html#3569" class="InductiveConstructor">RequireTimeStart</a> <a id="4453" href="Ledger.Script.html#3865" class="Generalizable">a</a><a id="4454" class="Symbol">)</a>
      <a id="4462" href="Ledger.Script.html#4462" class="InductiveConstructor">evalTEx</a>  <a id="4471" class="Symbol">:</a> <a id="4473" href="Ledger.Script.html#3932" class="Bound">I</a> <a id="4475" class="Symbol">.</a><a id="4476" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="4482" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4484" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4489" href="Ledger.Script.html#3869" class="Generalizable">r</a> <a id="4491" class="Symbol">→</a> <a id="4493" href="Ledger.Script.html#3869" class="Generalizable">r</a> <a id="4495" href="Ledger.Script.html#3713" class="Bound Operator">≤</a> <a id="4497" href="Ledger.Script.html#3865" class="Generalizable">a</a>
               <a id="4514" class="Symbol">→</a> <a id="4516" href="Ledger.Script.html#3976" class="Datatype">evalTimelock</a> <a id="4529" class="Symbol">(</a><a id="4530" href="Ledger.Script.html#3569" class="InductiveConstructor">RequireTimeStart</a> <a id="4547" href="Ledger.Script.html#3865" class="Generalizable">a</a><a id="4548" class="Symbol">)</a>
<a id="4550" class="Markup">\end{code}</a><a id="4560" class="Background">
\caption{Timelock scripts and their evaluation}
\label{fig:defs:timelock}
\end{figure*}

</a><a id="4650" class="Markup">\begin{code}[hide]</a>
  <a id="4671" class="Keyword">module</a> <a id="4678" href="Ledger.Script.html#4678" class="Module">_</a> <a id="4680" class="Symbol">(</a><a id="4681" href="Ledger.Script.html#4681" class="Bound">khs</a> <a id="4685" class="Symbol">:</a> <a id="4687" href="Ledger.Set.Theory.html#412" class="Function Operator">ℙ</a> <a id="4689" href="Ledger.Crypto.html#1698" class="Function">KeyHash</a><a id="4696" class="Symbol">)</a> <a id="4698" class="Keyword">where</a>
    <a id="4708" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4722" class="Symbol">:</a> <a id="4724" class="Symbol">(</a><a id="4725" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4731" href="Ledger.Epoch.html#341" class="Function">Slot</a> <a id="4736" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="4738" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4744" href="Ledger.Epoch.html#341" class="Function">Slot</a><a id="4748" class="Symbol">)</a> <a id="4750" class="Symbol">→</a> <a id="4752" href="Ledger.Script.html#3334" class="Datatype">Timelock</a> <a id="4761" class="Symbol">→</a> <a id="4763" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
    <a id="4772" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4786" href="Ledger.Script.html#4786" class="Bound">I</a> <a id="4788" class="Symbol">(</a><a id="4789" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a> <a id="4802" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4804" class="Symbol">)</a>                   <a id="4824" class="Symbol">=</a> <a id="4826" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
    <a id="4835" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4849" href="Ledger.Script.html#4849" class="Bound">I</a> <a id="4851" class="Symbol">(</a><a id="4852" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a> <a id="4865" class="Symbol">(</a><a id="4866" href="Ledger.Script.html#4866" class="Bound">x</a> <a id="4868" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4870" href="Ledger.Script.html#4870" class="Bound">xs</a><a id="4872" class="Symbol">))</a>             <a id="4887" class="Symbol">=</a>
      <a id="4895" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4909" href="Ledger.Script.html#4849" class="Bound">I</a> <a id="4911" href="Ledger.Script.html#4866" class="Bound">x</a> <a id="4913" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="4915" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4929" href="Ledger.Script.html#4849" class="Bound">I</a> <a id="4931" class="Symbol">(</a><a id="4932" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a> <a id="4945" href="Ledger.Script.html#4870" class="Bound">xs</a><a id="4947" class="Symbol">)</a>
    <a id="4953" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="4967" href="Ledger.Script.html#4967" class="Bound">I</a> <a id="4969" class="Symbol">(</a><a id="4970" href="Ledger.Script.html#3410" class="InductiveConstructor">RequireAnyOf</a> <a id="4983" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4985" class="Symbol">)</a>                   <a id="5005" class="Symbol">=</a> <a id="5007" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
    <a id="5017" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5031" href="Ledger.Script.html#5031" class="Bound">I</a> <a id="5033" class="Symbol">(</a><a id="5034" href="Ledger.Script.html#3410" class="InductiveConstructor">RequireAnyOf</a> <a id="5047" class="Symbol">(</a><a id="5048" href="Ledger.Script.html#5048" class="Bound">x</a> <a id="5050" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5052" href="Ledger.Script.html#5052" class="Bound">xs</a><a id="5054" class="Symbol">))</a>             <a id="5069" class="Symbol">=</a>
      <a id="5077" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5091" href="Ledger.Script.html#5031" class="Bound">I</a> <a id="5093" href="Ledger.Script.html#5048" class="Bound">x</a> <a id="5095" href="Data.Bool.Base.html#1044" class="Function Operator">∨</a> <a id="5097" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5111" href="Ledger.Script.html#5031" class="Bound">I</a> <a id="5113" class="Symbol">(</a><a id="5114" href="Ledger.Script.html#3357" class="InductiveConstructor">RequireAllOf</a> <a id="5127" href="Ledger.Script.html#5052" class="Bound">xs</a><a id="5129" class="Symbol">)</a>
    <a id="5135" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5149" href="Ledger.Script.html#5149" class="Bound">I</a> <a id="5151" class="Symbol">(</a><a id="5152" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="5163" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="5168" class="Symbol">_)</a>                 <a id="5187" class="Symbol">=</a> <a id="5189" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
    <a id="5198" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5212" href="Ledger.Script.html#5212" class="Bound">I</a> <a id="5214" class="Symbol">(</a><a id="5215" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="5226" class="Symbol">(</a><a id="5227" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5231" class="Symbol">_)</a> <a id="5234" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5236" class="Symbol">)</a>             <a id="5250" class="Symbol">=</a> <a id="5252" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
    <a id="5262" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5276" href="Ledger.Script.html#5276" class="Bound">I</a> <a id="5278" class="Symbol">(</a><a id="5279" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="5290" class="Symbol">(</a><a id="5291" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5295" href="Ledger.Script.html#5295" class="Bound">m</a><a id="5296" class="Symbol">)</a> <a id="5298" class="Symbol">(</a><a id="5299" href="Ledger.Script.html#5299" class="Bound">x</a> <a id="5301" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5303" href="Ledger.Script.html#5303" class="Bound">xs</a><a id="5305" class="Symbol">))</a>       <a id="5314" class="Symbol">=</a> <a id="5316" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5319" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5333" href="Ledger.Script.html#5276" class="Bound">I</a> <a id="5335" href="Ledger.Script.html#5299" class="Bound">x</a>
      <a id="5343" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>  <a id="5349" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5363" href="Ledger.Script.html#5276" class="Bound">I</a> <a id="5365" class="Symbol">(</a><a id="5366" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="5377" href="Ledger.Script.html#5295" class="Bound">m</a> <a id="5379" href="Ledger.Script.html#5303" class="Bound">xs</a><a id="5381" class="Symbol">)</a>
      <a id="5389" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>  <a id="5395" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5409" href="Ledger.Script.html#5276" class="Bound">I</a> <a id="5411" class="Symbol">(</a><a id="5412" href="Ledger.Script.html#3463" class="InductiveConstructor">RequireMOf</a> <a id="5423" class="Symbol">(</a><a id="5424" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5428" href="Ledger.Script.html#5295" class="Bound">m</a><a id="5429" class="Symbol">)</a> <a id="5431" href="Ledger.Script.html#5303" class="Bound">xs</a><a id="5433" class="Symbol">)</a>
    <a id="5439" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5453" href="Ledger.Script.html#5453" class="Bound">I</a> <a id="5455" class="Symbol">(</a><a id="5456" href="Ledger.Script.html#3516" class="InductiveConstructor">RequireSig</a> <a id="5467" href="Ledger.Script.html#5467" class="Bound">x</a><a id="5468" class="Symbol">)</a>                      <a id="5491" class="Symbol">=</a> <a id="5493" href="Ledger.Script.html#5467" class="Bound">x</a> <a id="5495" href="Axiom.Set.html#10584" class="Function Operator">∈ᵇ</a> <a id="5498" href="Ledger.Script.html#4681" class="Bound">khs</a>
    <a id="5506" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5520" class="Symbol">(</a><a id="5521" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="5526" href="Ledger.Script.html#5526" class="Bound">l</a>  <a id="5529" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5531" class="Symbol">_)</a>  <a id="5535" class="Symbol">(</a><a id="5536" href="Ledger.Script.html#3569" class="InductiveConstructor">RequireTimeStart</a> <a id="5553" href="Ledger.Script.html#5553" class="Bound">x</a><a id="5554" class="Symbol">)</a>   <a id="5558" class="Symbol">=</a> <a id="5560" href="Ledger.Script.html#5553" class="Bound">x</a> <a id="5562" href="Ledger.Script.html#3739" class="Bound Operator">≤ᵇ</a> <a id="5565" href="Ledger.Script.html#5526" class="Bound">l</a>
    <a id="5571" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5585" class="Symbol">(</a><a id="5586" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="5594" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5596" class="Symbol">_)</a>  <a id="5600" class="Symbol">(</a><a id="5601" href="Ledger.Script.html#3569" class="InductiveConstructor">RequireTimeStart</a> <a id="5618" href="Ledger.Script.html#5618" class="Bound">x</a><a id="5619" class="Symbol">)</a>   <a id="5623" class="Symbol">=</a> <a id="5625" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
    <a id="5635" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5649" class="Symbol">(_</a> <a id="5652" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5654" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="5659" href="Ledger.Script.html#5659" class="Bound">r</a> <a id="5661" class="Symbol">)</a>  <a id="5664" class="Symbol">(</a><a id="5665" href="Ledger.Script.html#3622" class="InductiveConstructor">RequireTimeExpire</a> <a id="5683" href="Ledger.Script.html#5683" class="Bound">x</a><a id="5684" class="Symbol">)</a>  <a id="5687" class="Symbol">=</a> <a id="5689" href="Ledger.Script.html#5659" class="Bound">r</a> <a id="5691" href="Ledger.Script.html#3739" class="Bound Operator">≤ᵇ</a> <a id="5694" href="Ledger.Script.html#5683" class="Bound">x</a>
    <a id="5700" href="Ledger.Script.html#4708" class="Function">evalTimelockᵇ</a> <a id="5714" class="Symbol">(_</a> <a id="5717" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5719" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="5726" class="Symbol">)</a>  <a id="5729" class="Symbol">(</a><a id="5730" href="Ledger.Script.html#3622" class="InductiveConstructor">RequireTimeExpire</a> <a id="5748" href="Ledger.Script.html#5748" class="Bound">x</a><a id="5749" class="Symbol">)</a>  <a id="5752" class="Symbol">=</a> <a id="5754" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>

  <a id="5763" class="Keyword">unquoteDecl</a> <a id="5775" href="Ledger.Script.html#5775" class="Function">DecEq-Timelock</a> <a id="5790" class="Symbol">=</a> <a id="5792" href="Tactic.Derive.DecEq.html#3471" class="Function">derive-DecEq</a> <a id="5805" class="Symbol">((</a><a id="5807" class="Keyword">quote</a> <a id="5813" href="Ledger.Script.html#3334" class="Datatype">Timelock</a> <a id="5822" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5824" href="Ledger.Script.html#5775" class="Function">DecEq-Timelock</a><a id="5838" class="Symbol">)</a> <a id="5840" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5842" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5844" class="Symbol">)</a>

  <a id="5849" class="Keyword">open</a> <a id="5854" href="Ledger.Script.html#590" class="Module">P1ScriptStructure</a>

  <a id="5875" class="Comment">-- P1ScriptStructure-TL : Hashable Timelock ScriptHash → P1ScriptStructure</a>
  <a id="5952" class="Comment">-- P1ScriptStructure-TL h .P1Script = Timelock</a>
  <a id="6001" class="Comment">-- P1ScriptStructure-TL h .validP1Script = evalTimelock</a>
  <a id="6059" class="Comment">-- P1ScriptStructure-TL h .validP1Script? = {!!}</a>
  <a id="6110" class="Comment">-- P1ScriptStructure-TL h .Hashable-P1Script = h</a>
  <a id="6161" class="Comment">-- P1ScriptStructure-TL h .DecEq-P1Script = DecEq-Timelock</a>
<a id="6220" class="Markup">\end{code}</a><a id="6230" class="Background">
</a></pre></body></html>