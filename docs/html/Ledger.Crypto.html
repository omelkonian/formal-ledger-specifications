<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Cryptographic primitives}
</a><a id="36" class="Markup">\begin{code}[hide]</a>
<a id="55" class="Symbol">{-#</a> <a id="59" class="Keyword">OPTIONS</a> <a id="67" class="Pragma">--safe</a> <a id="74" class="Symbol">#-}</a>
<a id="78" class="Keyword">module</a> <a id="85" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a> <a id="99" class="Keyword">where</a>

<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="133" class="Keyword">hiding</a> <a id="140" class="Symbol">(</a><a id="141" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="142" class="Symbol">)</a>

<a id="145" class="Keyword">record</a> <a id="isHashableSet"></a><a id="152" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="166" class="Symbol">(</a><a id="167" href="Ledger.Crypto.html#167" class="Bound">T</a> <a id="169" class="Symbol">:</a> <a id="171" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="174" class="Symbol">)</a> <a id="176" class="Symbol">:</a> <a id="178" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="183" class="Keyword">where</a>
  <a id="191" class="Keyword">constructor</a> <a id="mkIsHashableSet"></a><a id="203" href="Ledger.Crypto.html#203" class="InductiveConstructor">mkIsHashableSet</a>
  <a id="221" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="227" href="Ledger.Crypto.html#227" class="Field">THash</a> <a id="233" class="Symbol">:</a> <a id="235" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="247" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-THash"></a><a id="249" href="Ledger.Crypto.html#249" class="Field">DecEq-THash</a> <a id="261" class="Symbol">⦄</a> <a id="263" class="Symbol">:</a> <a id="265" href="Interface.DecEq.html#185" class="Record">DecEq</a>      <a id="276" href="Ledger.Crypto.html#227" class="Field">THash</a>
        <a id="290" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-T"></a><a id="292" href="Ledger.Crypto.html#292" class="Field">DecEq-T</a>     <a id="304" class="Symbol">⦄</a> <a id="306" class="Symbol">:</a> <a id="308" href="Interface.DecEq.html#185" class="Record">DecEq</a>    <a id="317" href="Ledger.Crypto.html#167" class="Bound">T</a>
        <a id="327" class="Symbol">⦃</a> <a id="isHashableSet.T-Hashable"></a><a id="329" href="Ledger.Crypto.html#329" class="Field">T-Hashable</a>  <a id="341" class="Symbol">⦄</a> <a id="343" class="Symbol">:</a> <a id="345" href="Interface.Hashable.html#150" class="Record">Hashable</a> <a id="354" href="Ledger.Crypto.html#167" class="Bound">T</a> <a id="356" href="Ledger.Crypto.html#227" class="Field">THash</a>
<a id="362" class="Keyword">open</a> <a id="367" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a>

<a id="382" class="Keyword">record</a> <a id="HashableSet"></a><a id="389" href="Ledger.Crypto.html#389" class="Record">HashableSet</a> <a id="401" class="Symbol">:</a> <a id="403" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="408" class="Keyword">where</a>
  <a id="416" class="Keyword">constructor</a> <a id="mkHashableSet"></a><a id="428" href="Ledger.Crypto.html#428" class="InductiveConstructor">mkHashableSet</a>
  <a id="444" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="450" href="Ledger.Crypto.html#450" class="Field">T</a> <a id="452" class="Symbol">:</a> <a id="454" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="457" class="Symbol">;</a> <a id="459" class="Symbol">⦃</a> <a id="HashableSet.T-isHashable"></a><a id="461" href="Ledger.Crypto.html#461" class="Field">T-isHashable</a> <a id="474" class="Symbol">⦄</a> <a id="476" class="Symbol">:</a> <a id="478" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="492" href="Ledger.Crypto.html#450" class="Field">T</a>
  <a id="496" class="Keyword">open</a> <a id="501" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a> <a id="515" href="Ledger.Crypto.html#461" class="Field">T-isHashable</a> <a id="528" class="Keyword">public</a>

<a id="536" class="Keyword">record</a> <a id="PKKScheme"></a><a id="543" href="Ledger.Crypto.html#543" class="Record">PKKScheme</a> <a id="553" class="Symbol">:</a> <a id="555" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="560" class="Keyword">where</a>
  <a id="568" class="Keyword">field</a>
<a id="574" class="Markup">\end{code}</a><a id="584" class="Background">
We rely on a public key signing scheme for verification of spending.
\begin{figure*}[h]
\emph{Types \&amp; functions}
</a><a id="699" class="Markup">\begin{code}</a>
        <a id="PKKScheme.SKey"></a><a id="720" href="Ledger.Crypto.html#720" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="725" href="Ledger.Crypto.html#725" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="730" href="Ledger.Crypto.html#730" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="734" href="Ledger.Crypto.html#734" class="Field">Ser</a> <a id="738" class="Symbol">:</a> <a id="740" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.isKeyPair"></a><a id="752" href="Ledger.Crypto.html#752" class="Field">isKeyPair</a> <a id="762" class="Symbol">:</a> <a id="764" href="Ledger.Crypto.html#720" class="Field">SKey</a> <a id="769" class="Symbol">→</a> <a id="771" href="Ledger.Crypto.html#725" class="Field">VKey</a> <a id="776" class="Symbol">→</a> <a id="778" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.isSigned"></a><a id="790" href="Ledger.Crypto.html#790" class="Field">isSigned</a> <a id="799" class="Symbol">:</a> <a id="801" href="Ledger.Crypto.html#725" class="Field">VKey</a> <a id="806" class="Symbol">→</a> <a id="808" href="Ledger.Crypto.html#734" class="Field">Ser</a> <a id="812" class="Symbol">→</a> <a id="814" href="Ledger.Crypto.html#730" class="Field">Sig</a> <a id="818" class="Symbol">→</a> <a id="820" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.sign"></a><a id="832" href="Ledger.Crypto.html#832" class="Field">sign</a> <a id="837" class="Symbol">:</a> <a id="839" href="Ledger.Crypto.html#720" class="Field">SKey</a> <a id="844" class="Symbol">→</a> <a id="846" href="Ledger.Crypto.html#734" class="Field">Ser</a> <a id="850" class="Symbol">→</a> <a id="852" href="Ledger.Crypto.html#730" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="859" href="Ledger.Crypto.html#859" class="Function">KeyPair</a> <a id="867" class="Symbol">=</a> <a id="869" href="Data.Product.Base.html#858" class="Function">Σ[</a> <a id="872" href="Ledger.Crypto.html#872" class="Bound">sk</a> <a id="875" href="Data.Product.Base.html#858" class="Function">∈</a> <a id="877" href="Ledger.Crypto.html#720" class="Field">SKey</a> <a id="882" href="Data.Product.Base.html#858" class="Function">]</a> <a id="884" href="Data.Product.Base.html#858" class="Function">Σ[</a> <a id="887" href="Ledger.Crypto.html#887" class="Bound">vk</a> <a id="890" href="Data.Product.Base.html#858" class="Function">∈</a> <a id="892" href="Ledger.Crypto.html#725" class="Field">VKey</a> <a id="897" href="Data.Product.Base.html#858" class="Function">]</a> <a id="899" href="Ledger.Crypto.html#752" class="Field">isKeyPair</a> <a id="909" href="Ledger.Crypto.html#872" class="Bound">sk</a> <a id="912" href="Ledger.Crypto.html#887" class="Bound">vk</a>
<a id="915" class="Markup">\end{code}</a><a id="925" class="Background">
\emph{Property of signatures}
</a><a id="956" class="Markup">\begin{code}[hide]</a>
  <a id="977" class="Keyword">field</a> <a id="PKKScheme.isSigned?"></a><a id="983" href="Ledger.Crypto.html#983" class="Field">isSigned?</a> <a id="993" class="Symbol">:</a> <a id="995" class="Symbol">∀</a> <a id="997" href="Ledger.Crypto.html#997" class="Bound">vk</a> <a id="1000" href="Ledger.Crypto.html#1000" class="Bound">d</a> <a id="1002" href="Ledger.Crypto.html#1002" class="Bound">σ</a> <a id="1004" class="Symbol">→</a> <a id="1006" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1010" class="Symbol">(</a><a id="1011" href="Ledger.Crypto.html#790" class="Field">isSigned</a> <a id="1020" href="Ledger.Crypto.html#997" class="Bound">vk</a> <a id="1023" href="Ledger.Crypto.html#1000" class="Bound">d</a> <a id="1025" href="Ledger.Crypto.html#1002" class="Bound">σ</a><a id="1026" class="Symbol">)</a>
        <a id="PKKScheme.isSigned-correct"></a><a id="1036" href="Ledger.Crypto.html#1036" class="Field">isSigned-correct</a> <a id="1053" class="Symbol">:</a>
<a id="1055" class="Markup">\end{code}</a><a id="1065" class="Background">
</a><a id="1066" class="Markup">\begin{code}</a>
          <a id="1089" class="Symbol">(</a><a id="1090" href="Ledger.Crypto.html#1090" class="Bound">(</a><a id="1091" href="Ledger.Crypto.html#1091" class="Bound">sk</a> <a id="1094" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1096" href="Ledger.Crypto.html#1096" class="Bound">vk</a> <a id="1099" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1101" href="Ledger.Crypto.html#1090" class="Bound">_)</a> <a id="1104" class="Symbol">:</a> <a id="1106" href="Ledger.Crypto.html#859" class="Function">KeyPair</a><a id="1113" class="Symbol">)</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Ledger.Crypto.html#1116" class="Bound">d</a> <a id="1118" class="Symbol">:</a> <a id="1120" href="Ledger.Crypto.html#734" class="Field">Ser</a><a id="1123" class="Symbol">)</a> <a id="1125" class="Symbol">(</a><a id="1126" href="Ledger.Crypto.html#1126" class="Bound">σ</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="Ledger.Crypto.html#730" class="Field">Sig</a><a id="1133" class="Symbol">)</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Ledger.Crypto.html#832" class="Field">sign</a> <a id="1142" href="Ledger.Crypto.html#1091" class="Bound">sk</a> <a id="1145" href="Ledger.Crypto.html#1116" class="Bound">d</a> <a id="1147" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1149" href="Ledger.Crypto.html#1126" class="Bound">σ</a> <a id="1151" class="Symbol">→</a> <a id="1153" href="Ledger.Crypto.html#790" class="Field">isSigned</a> <a id="1162" href="Ledger.Crypto.html#1096" class="Bound">vk</a> <a id="1165" href="Ledger.Crypto.html#1116" class="Bound">d</a> <a id="1167" href="Ledger.Crypto.html#1126" class="Bound">σ</a>
<a id="1169" class="Markup">\end{code}</a><a id="1179" class="Background">
\caption{Definitions for the public key signature scheme}
\label{fig:defs:crypto}
\end{figure*}
</a><a id="1276" class="Markup">\begin{code}[hide]</a>
        <a id="1303" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Sig"></a><a id="1305" href="Ledger.Crypto.html#1305" class="Field">DecEq-Sig</a>  <a id="1316" class="Symbol">⦄</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1326" href="Ledger.Crypto.html#730" class="Field">Sig</a>
        <a id="1338" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Ser"></a><a id="1340" href="Ledger.Crypto.html#1340" class="Field">DecEq-Ser</a>  <a id="1351" class="Symbol">⦄</a> <a id="1353" class="Symbol">:</a> <a id="1355" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1361" href="Ledger.Crypto.html#734" class="Field">Ser</a>
  <a id="1367" class="Keyword">instance</a>
    <a id="PKKScheme.Dec-isSigned"></a><a id="1380" href="Ledger.Crypto.html#1380" class="Function">Dec-isSigned</a> <a id="1393" class="Symbol">:</a> <a id="1395" class="Symbol">∀</a> <a id="1397" class="Symbol">{</a><a id="1398" href="Ledger.Crypto.html#1398" class="Bound">vk</a> <a id="1401" href="Ledger.Crypto.html#1401" class="Bound">d</a> <a id="1403" href="Ledger.Crypto.html#1403" class="Bound">σ</a><a id="1404" class="Symbol">}</a> <a id="1406" class="Symbol">→</a> <a id="1408" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1412" class="Symbol">(</a><a id="1413" href="Ledger.Crypto.html#790" class="Field">isSigned</a> <a id="1422" href="Ledger.Crypto.html#1398" class="Bound">vk</a> <a id="1425" href="Ledger.Crypto.html#1401" class="Bound">d</a> <a id="1427" href="Ledger.Crypto.html#1403" class="Bound">σ</a><a id="1428" class="Symbol">)</a>
    <a id="1434" href="Ledger.Crypto.html#1380" class="Function">Dec-isSigned</a> <a id="1447" class="Symbol">=</a> <a id="1449" href="Ledger.Crypto.html#983" class="Field">isSigned?</a> <a id="1459" class="Symbol">_</a> <a id="1461" class="Symbol">_</a> <a id="1463" class="Symbol">_</a>

<a id="1466" class="Keyword">record</a> <a id="Crypto"></a><a id="1473" href="Ledger.Crypto.html#1473" class="Record">Crypto</a> <a id="1480" class="Symbol">:</a> <a id="1482" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="1487" class="Keyword">where</a>
  <a id="1495" class="Keyword">field</a> <a id="Crypto.pkk"></a><a id="1501" href="Ledger.Crypto.html#1501" class="Field">pkk</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Ledger.Crypto.html#543" class="Record">PKKScheme</a>

  <a id="1520" class="Keyword">open</a> <a id="1525" href="Ledger.Crypto.html#543" class="Module">PKKScheme</a> <a id="1535" href="Ledger.Crypto.html#1501" class="Field">pkk</a> <a id="1539" class="Keyword">public</a>

  <a id="1549" class="Keyword">field</a> <a id="1555" class="Symbol">⦃</a> <a id="Crypto.khs"></a><a id="1557" href="Ledger.Crypto.html#1557" class="Field">khs</a> <a id="1561" class="Symbol">⦄</a>    <a id="1566" class="Symbol">:</a> <a id="1568" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="1582" href="Ledger.Crypto.html#725" class="Function">VKey</a>
        <a id="Crypto.ScriptHash"></a><a id="1595" href="Ledger.Crypto.html#1595" class="Field">ScriptHash</a> <a id="1606" class="Symbol">:</a> <a id="1608" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="1611" class="Symbol">;</a> <a id="1613" class="Symbol">⦃</a> <a id="Crypto.DecEq-ScriptHash"></a><a id="1615" href="Ledger.Crypto.html#1615" class="Field">DecEq-ScriptHash</a> <a id="1632" class="Symbol">⦄</a> <a id="1634" class="Symbol">:</a> <a id="1636" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1642" href="Ledger.Crypto.html#1595" class="Field">ScriptHash</a>

  <a id="1656" class="Keyword">open</a> <a id="1661" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a> <a id="1675" href="Ledger.Crypto.html#1557" class="Field">khs</a> <a id="1679" class="Keyword">renaming</a> <a id="1688" class="Symbol">(</a><a id="1689" href="Ledger.Crypto.html#227" class="Field">THash</a> <a id="1695" class="Symbol">to</a> <a id="1698" class="Field">KeyHash</a><a id="1705" class="Symbol">)</a> <a id="1707" class="Keyword">hiding</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Ledger.Crypto.html#292" class="Field">DecEq-T</a><a id="1722" class="Symbol">)</a> <a id="1724" class="Keyword">public</a>

<a id="1732" class="Comment">-- TODO: KES and VRF</a>
<a id="1753" class="Markup">\end{code}</a><a id="1763" class="Background">
</a></pre></body></html>